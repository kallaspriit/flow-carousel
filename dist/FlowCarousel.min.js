!function(t,e){"function"==typeof define&&define.amd?define([],e):t.FlowCarousel=e()}(this,function(){var t,e,i;return function(n){function r(t,e){return y.call(t,e)}function o(t,e){var i,n,r,o,s,a,h,u,l,d,c,p=e&&e.split("/"),m=v.map,_=m&&m["*"]||{};if(t&&"."===t.charAt(0))if(e){for(p=p.slice(0,p.length-1),t=t.split("/"),s=t.length-1,v.nodeIdCompat&&E.test(t[s])&&(t[s]=t[s].replace(E,"")),t=p.concat(t),l=0;l<t.length;l+=1)if(c=t[l],"."===c)t.splice(l,1),l-=1;else if(".."===c){if(1===l&&(".."===t[2]||".."===t[0]))break;l>0&&(t.splice(l-1,2),l-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((p||_)&&m){for(i=t.split("/"),l=i.length;l>0;l-=1){if(n=i.slice(0,l).join("/"),p)for(d=p.length;d>0;d-=1)if(r=m[p.slice(0,d).join("/")],r&&(r=r[n])){o=r,a=l;break}if(o)break;!h&&_&&_[n]&&(h=_[n],u=l)}!o&&h&&(o=h,a=u),o&&(i.splice(0,a,o),t=i.join("/"))}return t}function s(t,e){return function(){return p.apply(n,w.call(arguments,0).concat([t,e]))}}function a(t){return function(e){return o(e,t)}}function h(t){return function(e){g[t]=e}}function u(t){if(r(f,t)){var e=f[t];delete f[t],I[t]=!0,c.apply(n,e)}if(!r(g,t)&&!r(I,t))throw new Error("No "+t);return g[t]}function l(t){var e,i=t?t.indexOf("!"):-1;return i>-1&&(e=t.substring(0,i),t=t.substring(i+1,t.length)),[e,t]}function d(t){return function(){return v&&v.config&&v.config[t]||{}}}var c,p,m,_,g={},f={},v={},I={},y=Object.prototype.hasOwnProperty,w=[].slice,E=/\.js$/;m=function(t,e){var i,n=l(t),r=n[0];return t=n[1],r&&(r=o(r,e),i=u(r)),r?t=i&&i.normalize?i.normalize(t,a(e)):o(t,e):(t=o(t,e),n=l(t),r=n[0],t=n[1],r&&(i=u(r))),{f:r?r+"!"+t:t,n:t,pr:r,p:i}},_={require:function(t){return s(t)},exports:function(t){var e=g[t];return"undefined"!=typeof e?e:g[t]={}},module:function(t){return{id:t,uri:"",exports:g[t],config:d(t)}}},c=function(t,e,i,o){var a,l,d,c,p,v,y=[],w=typeof i;if(o=o||t,"undefined"===w||"function"===w){for(e=!e.length&&i.length?["require","exports","module"]:e,p=0;p<e.length;p+=1)if(c=m(e[p],o),l=c.f,"require"===l)y[p]=_.require(t);else if("exports"===l)y[p]=_.exports(t),v=!0;else if("module"===l)a=y[p]=_.module(t);else if(r(g,l)||r(f,l)||r(I,l))y[p]=u(l);else{if(!c.p)throw new Error(t+" missing "+l);c.p.load(c.n,s(o,!0),h(l),{}),y[p]=g[l]}d=i?i.apply(g[t],y):void 0,t&&(a&&a.exports!==n&&a.exports!==g[t]?g[t]=a.exports:d===n&&v||(g[t]=d))}else t&&(g[t]=i)},t=e=p=function(t,e,i,r,o){if("string"==typeof t)return _[t]?_[t](e):u(m(t,e).f);if(!t.splice){if(v=t,v.deps&&p(v.deps,v.callback),!e)return;e.splice?(t=e,e=i,i=null):t=n}return e=e||function(){},"function"==typeof i&&(i=r,r=o),r?c(n,t,e,i):setTimeout(function(){c(n,t,e,i)},4),p},p.config=function(t){return p(t)},t._defined=g,i=function(t,e,i){e.splice||(i=e,e=[]),r(g,t)||r(f,t)||(f[t]=[t,e,i])},i.amd={jQuery:!0}}(),i("almond",function(){}),i("jquery",["jquery"],function(){return window.jQuery}),i("Deferred",["jquery"],function(t){var e=t.Deferred;return e.when=t.when,e}),i("AbstractNavigator",[],function(){function t(){this._carousel=null}return t.prototype.init=function(t){this._carousel=t,this._setup()},t.prototype.destroy=function(){},t.prototype._setup=function(){throw new Error("Not implemented")},t}),i("Util",[],function(){return{isObject:function(t){return"object"==typeof t&&null!==t},isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},objectHasValue:function(t,e){var i;for(i in t)if(t.hasOwnProperty(i)&&t[i]===e)return!0;return!1},parseTransformMatrix:function(t){var e,i,n,r,o,s;if("matrix3d"===t.substring(0,8))e=9,i=[12,13];else if("matrix"===t.substring(0,6))e=7,i=[4,5];else{if("translate3d"!==t.substring(0,11))throw new Error('Unsupported matrix format "'+t+'"');e=12,i=[0,1]}return n=t.substr(e).substr(0,t.length-e-1),r=n.replace(/ +/g,""),o=r.split(/,/),s={x:parseInt(o[i[0]],10),y:parseInt(o[i[1]],10)}},removeElementClassesPrefixedWith:function(t,e){var i,n=$(t).prop("class").split(" "),r=[];for(i=0;i<n.length;i++)n[i].substr(0,e.length)!==e&&r.push(n[i]);$(t).prop("class",r.join(" "))},cloneObj:function(t){return JSON.parse(JSON.stringify(t))}}}),i("KeyboardNavigator",["AbstractNavigator","Util"],function(t,e){function i(e){t.call(this),this._config=e,this._mode=null,this._mouseEntered=!1,this._eventListeners={mouseenter:this._onRawMouseEnter.bind(this),mouseleave:this._onRawMouseLeave.bind(this),keydown:this._onRawKeyDown.bind(this)},this.setMode(e.mode||i.Mode.NAVIGATE_PAGE)}return i.prototype=Object.create(t.prototype),i.Mode={NAVIGATE_PAGE:"navigate-page",NAVIGATE_ITEM:"navigate-item"},i.prototype.setMode=function(t){if(!e.objectHasValue(i.Mode,t))throw new Error('Invalid mode "'+t+'" provided');this._mode=t},i.prototype.getMode=function(){return this._mode},i.prototype._setup=function(){var t=$(this._carousel.getMainWrap()),e=$(window);t.on("mouseenter",this._eventListeners.mouseenter).on("mouseleave",this._eventListeners.mouseleave),e.on("keydown",this._eventListeners.keydown)},i.prototype.destroy=function(){var t=$(this._carousel.getMainWrap()),e=$(window);t.off("mouseenter",this._eventListeners.mouseenter).off("mouseleave",this._eventListeners.mouseleave),e.off("keydown",this._eventListeners.keydown)},i.prototype._onRawMouseEnter=function(){this._mouseEntered=!0},i.prototype._onRawMouseLeave=function(){this._mouseEntered=!1},i.prototype._onRawKeyDown=function(t){var e=this._onKeyDown(t.keyCode);return e===!1&&t.preventDefault(),e},i.prototype._onKeyDown=function(t){var e;if(this._mouseEntered){switch(this._carousel.getOrientation()){case this._carousel.Config.Orientation.HORIZONTAL:e={previous:37,next:39};break;case this._carousel.Config.Orientation.VERTICAL:e={previous:38,next:40}}switch(t){case e.next:return this._mode===i.Mode.NAVIGATE_PAGE?this._carousel.navigateToNextPage():this._mode===i.Mode.NAVIGATE_ITEM&&this._carousel.navigateToNextItem(),!1;case e.previous:return this._mode===i.Mode.NAVIGATE_PAGE?this._carousel.navigateToPreviousPage():this._mode===i.Mode.NAVIGATE_ITEM&&this._carousel.navigateToPreviousItem(),!1}return!0}},i}),i("DragNavigator",["AbstractNavigator","Util"],function(t,e){function i(e){t.call(this),this._config=e,this._mode=null,this._active=!1,this._stoppedExistingAnimation=!1,this._startedDragging=!1,this._startDragPosition=null,this._startOppositePosition=null,this._startCarouselPosition=null,this._startHoverItemIndex=null,this._startTargetElement=null,this._startWindowScrollTop=null,this._lastDragPosition=null,this._lastOppositePosition=null,this._lastMoveTime=null,this._lastMoveDeltaTime=null,this._lastDeltaDragPosition=null,this._accumulatedMagnitude={main:0,opposite:0},this._eventListeners={start:this._onRawStart.bind(this),move:this._onRawMove.bind(this),end:this._onRawEnd.bind(this),dragStart:this._onRawDragStart.bind(this)},this._firstMoveEvent=!0,this._lastDragDirection=1,this.setMode(e.mode||i.Mode.NAVIGATE_PAGE)}return i.prototype=Object.create(t.prototype),i.Mode={NAVIGATE_PAGE:"navigate-page",NAVIGATE_ITEM:"navigate-item"},i.prototype.setMode=function(t){if(!e.objectHasValue(i.Mode,t))throw new Error('Invalid mode "'+t+'" provided');this._mode=t},i.prototype.getMode=function(){return this._mode},i.prototype._setup=function(){var t=$(this._carousel.getMainWrap()),e=$(this._carousel.getScrollerWrap()),i=$(window);e.on("mousedown touchstart",this._eventListeners.start),i.on("mousemove touchmove",this._eventListeners.move),i.on("mouseup touchend touchcancel",this._eventListeners.end),t.on("dragstart",this._eventListeners.dragStart)},i.prototype.destroy=function(){var t=$(this._carousel.getMainWrap()),e=$(this._carousel.getScrollerWrap()),i=$(window);e.off("mousedown touchstart",this._eventListeners.start),i.off("mousemove touchmove",this._eventListeners.move),i.off("mouseup touchend touchcancel",this._eventListeners.end),t.off("dragstart",this._eventListeners.dragStart)},i.prototype._onRawStart=function(t){if(1!==t.which&&"touchstart"!==t.type)return!0;var e,i=this._carousel.getOrientation(),n=i===this._carousel.Config.Orientation.HORIZONTAL,r="touchstart"===t.type,o=r?t.originalEvent.changedTouches[0].pageX:t.pageX,s=r?t.originalEvent.changedTouches[0].pageY:t.pageY,a=t.target;return e=this._begin(n?o:s,n?s:o,a),e===!1?(t.preventDefault(),!1):!0},i.prototype._onRawMove=function(t){var e,i,n,r=this._carousel.getOrientation(),o=r===this._carousel.Config.Orientation.HORIZONTAL,s="touchmove"===t.type;return this._active?(1!==t.which&&"touchmove"!==t.type?e=this._end(t.target,s):(i=s?t.originalEvent.changedTouches[0].pageX:t.pageX,n=s?t.originalEvent.changedTouches[0].pageY:t.pageY,e=this._move(o?i:n,o?n:i)),e===!1?(t.preventDefault(),!1):!0):!0},i.prototype._onRawEnd=function(t){var e,i,n="touchend"===t.type||"touchcancel"===t.type;return this._active?1!==t.which&&"touchend"!==t.type&&"touchcancel"!==t.type?!0:(i=t.target,e=this._end(i,n),e===!1?(t.preventDefault(),!1):!0):!0},i.prototype._onRawDragStart=function(){return!1},i.prototype._begin=function(t,e,i){return i=i||null,this._active=!0,this._startDragPosition=t,this._startOppositePosition=e,this._lastDragPosition=t,this._lastOppositePosition=e,this._lastMoveTime=(new Date).getTime(),this._startCarouselPosition=this._carousel.getAnimator().getCurrentPosition(),this._startHoverItemIndex=this._carousel.getHoverItemIndex(),this._startWindowScrollTop=$(window).scrollTop(),this._accumulatedMagnitude={main:0,opposite:0},this._firstMoveEvent=!0,null!==i&&(this._startTargetElement=i,this._disableClickHandlers(i)),this._carousel.isAnimating()&&(this._carousel.getAnimator().animateToPosition(this._startCarouselPosition,!0,!0),this._stoppedExistingAnimation=!0,this._startedDragging=!0),this._carousel._onDragBegin(this._startDragPosition,this._startOppositePosition,this._startCarouselPosition,this._startWindowScrollTop),this._stoppedExistingAnimation?!1:!0},i.prototype._move=function(t,e){if(!this._active)return!0;var i=t-this._startDragPosition,n=this._lastDragPosition-t,r=(new Date).getTime();if(this._accumulatedMagnitude.main+=Math.abs(n),this._accumulatedMagnitude.opposite+=Math.abs(this._lastOppositePosition-e),null!==this._lastMoveTime&&(this._lastMoveDeltaTime=r-this._lastMoveTime),null!==this._lastDragPosition&&(this._lastDeltaDragPosition=t-this._lastDragPosition),this._lastDragDirection=n>0?-1:1,this._lastDragPosition=t,this._lastOppositePosition=e,this._lastMoveTime=r,this._accumulatedMagnitude.main>0&&this._accumulatedMagnitude.main<this._accumulatedMagnitude.opposite&&!this._startedDragging)return this._end(),!0;if(this._startedDragging=!0,this._firstMoveEvent)return this._firstMoveEvent=!1,!1;var o=this._startCarouselPosition+i,s=o,a=this._carousel.getItemSize(),h=this._carousel.getTotalSize(),u=this._carousel.getItemCountOnLastPage(),l=this._config.overEdgeDragPositionMultiplier,d=0,c=-h+u*a;return(o>d||c>o)&&(s=(this._startCarouselPosition+i)*l),this._carousel.getAnimator().animateToPosition(s,!0,!0),!1},i.prototype._end=function(t,e){if(!this._active)return!0;e="boolean"==typeof e?e:!1;var n,r,o,s=this._carousel.getAnimator().getCurrentPosition(),a=this._lastDragPosition-this._startDragPosition,h=this._lastOppositePosition-this._startOppositePosition,u=Math.sqrt(Math.pow(a,2)+Math.pow(h,2)),l=this._config.ignoreClickThreshold,d=Math.abs(a)>0||this._stoppedExistingAnimation,c=Math.abs(this._lastDeltaDragPosition),p=c/this._lastMoveDeltaTime,m=!1;if(d)switch(this._mode){case i.Mode.NAVIGATE_PAGE:r=this._carousel.getClosestPageIndexAtPosition(s,this._lastDragDirection),this._carousel.navigateToPage(r,!1,!0,p);break;case i.Mode.NAVIGATE_ITEM:r=this._carousel.getClosestItemIndexAtPosition(s,this._lastDragDirection),this._carousel.navigateToItem(r,!1,!0,p)}return e?n=null!==t&&t===this._startTargetElement&&l>u:(o=this._carousel.getHoverItemIndex(),n=null!==this._startHoverItemIndex&&null!==t&&t===this._startTargetElement&&o===this._startHoverItemIndex&&l>u),n&&(this._restoreClickHandlers(t),this._dragStartHoverItemIndex=null,m=!0),this._carousel._onDragEnd(this._mode,this._startDragPosition,this._lastDragPosition,a,r,this._lastDragDirection,t),this._active=!1,this._stoppedExistingAnimation=!1,this._startedDragging=!1,this._startDragPosition=null,this._startOppositePosition=null,this._startCarouselPosition=null,this._startWindowScrollTop=null,this._lastDragPosition=null,this._lastMoveTime=null,this._lastMoveDeltaTime=null,this._lastDeltaDragPosition=null,this._accumulatedMagnitude={main:0,opposite:0},this._firstMoveEvent=!0,m},i.prototype._disableClickHandlers=function(t){var i,n,r,o=this._carousel.getConfig().cssPrefix+"click-disabled",s=$(t),a=s.closest("A"),h=s;if(a.length>0&&(n="."+this._carousel.getConfig().getClassName("wrap"),r=a.closest(n).length>0,r&&(h=a)),i=h.data(o),i!==!0){var u,l,d=$._data(h[0],"events"),c=[];if(e.isObject(d)&&e.isArray(d.click)&&d.click.length>0){for(u=d.click,l=0;l<u.length;l++)c.push(u[l].handler);h.data("original-click-handlers",c),h.off("click")}h.on("click",this._ignoreEvent),h.data(o,!0),h.attr("data-disabled","true")}},i.prototype._restoreClickHandlers=function(t){var i,n=this._carousel.getConfig().cssPrefix+"click-disabled",r=$(t),o=null;if("true"===r.attr("data-disabled")?o=r:(i=r.closest("A"),i.length>0&&"true"===i.attr("data-disabled")&&(o=i)),null!==o){var s,a=o.data("original-click-handlers");if(o.off("click"),e.isArray(a))for(s=0;s<a.length;s++)o.on("click",a[s].bind(t));o.data(n,!1),o.attr("data-disabled",null)}},i.prototype._ignoreEvent=function(t){return t.preventDefault(),t.stopPropagation(),!1},i}),i("SlideshowNavigator",["AbstractNavigator","Util"],function(t,e){function i(e){t.call(this),this._config=e,this._mode=null,this._delayTimeout=null,this._playing=!1,this._mouseEntered=!1,this._eventListeners={mouseenter:this._onRawMouseEnter.bind(this),mouseleave:this._onRawMouseLeave.bind(this)},this.setMode(e.mode||i.Mode.NAVIGATE_PAGE)}return i.prototype=Object.create(t.prototype),i.Mode={NAVIGATE_PAGE:"navigate-page",NAVIGATE_ITEM:"navigate-item"},i.prototype.setMode=function(t){if(!e.objectHasValue(i.Mode,t))throw new Error('Invalid mode "'+t+'" provided');this._mode=t},i.prototype.getMode=function(){return this._mode},i.prototype._setup=function(){var t=$(this._carousel.getMainWrap());t.on("mouseenter",this._eventListeners.mouseenter).on("mouseleave",this._eventListeners.mouseleave),this._carousel.on(this._carousel.Event.NAVIGATED_TO_ITEM,this._onNavigatedToItem.bind(this)),this.start()},i.prototype.destroy=function(){var t=$(this._carousel.getMainWrap());this.stop(),t.off("mouseenter",this._eventListeners.mouseenter).off("mouseleave",this._eventListeners.mouseleave)},i.prototype.isPlaying=function(){return this._playing},i.prototype.start=function(){this.isPlaying()&&this.stop(),this._playing=!0,this._scheduleNextChange()},i.prototype.stop=function(){null!==this._delayTimeout&&(window.clearTimeout(this._delayTimeout),this._delayTimeout=null),this._playing=!1},i.prototype._scheduleNextChange=function(){if(this.isPlaying()){var t=this._config.interval;null!==this._delayTimeout&&(window.clearTimeout(this._delayTimeout),this._delayTimeout=null),this._delayTimeout=window.setTimeout(function(){null!==this._carousel&&this._carousel.isInitiated()&&(this._performChange(),this._scheduleNextChange())}.bind(this),t)}},i.prototype._performChange=function(){if(!this._mouseEntered){var t=this._config.instantRollover;this._mode===i.Mode.NAVIGATE_PAGE?this._carousel.getPageCount()>0&&(this._carousel.isLastPage()?this._carousel.navigateToPage(0,t):this._carousel.navigateToNextPage()):this._mode===i.Mode.NAVIGATE_ITEM&&this._carousel.getItemCount()>0&&(this._carousel.isLastItem()?this._carousel.navigateToItem(0,t):this._carousel.navigateToNextItem())}},i.prototype._onRawMouseEnter=function(){this._mouseEntered=!0},i.prototype._onRawMouseLeave=function(){this._mouseEntered=!1,this._scheduleNextChange()},i.prototype._onNavigatedToItem=function(){this._scheduleNextChange()},i}),i("InterfaceNavigator",["AbstractNavigator","Util"],function(t,e){function i(e){t.call(this),this._config=e,this._mode=null,this._mouseEntered=!1,this._eventListeners={mouseenter:this._onRawMouseEnter.bind(this),mouseleave:this._onRawMouseLeave.bind(this)},this.setMode(e.mode||i.Mode.NAVIGATE_PAGE)}return i.prototype=Object.create(t.prototype),i.Mode={NAVIGATE_PAGE:"navigate-page",NAVIGATE_ITEM:"navigate-item"},i.prototype.setMode=function(t){if(!e.objectHasValue(i.Mode,t))throw new Error('Invalid mode "'+t+'" provided');this._mode=t},i.prototype.getMode=function(){return this._mode},i.prototype._setup=function(){var t=$(this._carousel.getMainWrap());t.on("mouseenter",this._eventListeners.mouseenter).on("mouseleave",this._eventListeners.mouseleave),this._carousel.on(this._carousel.Event.NAVIGATING_TO_ITEM,this._onNavigatingToItem.bind(this)),this._carousel.on(this._carousel.Event.LAYOUT_CHANGED,this._onLayoutChanged.bind(this)),this._redraw()},i.prototype._redraw=function(){var t,e,i=this._carousel.getConfig().cssPrefix,n={wrap:i+"interface",itemChoice:i+"item-choice"},r="navigate-page"===this._config.mode?this._carousel.getPageCount():this._carousel.getItemCount(),o=$(this._carousel.getMainWrap()),s=$("<div/>",{"class":n.wrap}),a=$("<ul/>",{"class":n.itemChoice}).appendTo(s);if(o.find("."+n.wrap).remove(),r>1){for(e=0;r>e;e++)t=$("<li/>").text(e+1).appendTo(a),t.click(function(t,e){this._onItemChoiceClick(e.target,t)}.bind(this,e));o.append(s),this._updateActiveItemChoice()}},i.prototype._onItemChoiceClick=function(t,e){this._mode===i.Mode.NAVIGATE_PAGE?this._carousel.navigateToPage(e):this._mode===i.Mode.NAVIGATE_ITEM&&this._carousel.navigateToItem(e)},i.prototype.destroy=function(){var t=this._carousel.getConfig().cssPrefix,e={wrap:t+"interface"},i=$(this._carousel.getMainWrap()),n=i.find("."+e.wrap);n.remove(),i.off("mouseenter",this._eventListeners.mouseenter).off("mouseleave",this._eventListeners.mouseleave)},i.prototype._onRawMouseEnter=function(){this._mouseEntered=!0},i.prototype._onRawMouseLeave=function(){this._mouseEntered=!1},i.prototype._onNavigatingToItem=function(){this._updateActiveItemChoice()},i.prototype._updateActiveItemChoice=function(){var t,e,n=this._carousel.getConfig().cssPrefix,r={wrap:n+"interface",itemChoice:n+"item-choice",isActive:n+"active-item-choice"},o=$(this._carousel.getMainWrap()),s=o.find("."+r.wrap),a=s.find("."+r.itemChoice),h=this._carousel.getTargetItemIndex();this._mode===i.Mode.NAVIGATE_PAGE?e=this._carousel.getItemPageIndex(h):this._mode===i.Mode.NAVIGATE_ITEM&&(e=h),t=a.find("LI:eq("+e+")"),a.find("LI."+r.isActive).removeClass(r.isActive),t.addClass(r.isActive)},i.prototype._onLayoutChanged=function(){this._redraw()},i}),i("Config",["jquery","Deferred","KeyboardNavigator","DragNavigator","SlideshowNavigator","InterfaceNavigator"],function(t,e,i,n,r,o){function s(){this.orientation=s.Orientation.HORIZONTAL,this.sizeMode=s.SizeMode.MATCH_WRAP,this.margin=0,this.usePlaceholders=!0,this.useResponsiveLayout=!0,this.itemsPerPage=5,this.startItemIndex=null,this.startPageIndex=null,this.animateToStartIndex=!1,this.centerStartItemIndex=!1,this.responsiveBreakpoints=[{size:0,itemsPerPage:1},{size:320,itemsPerPage:2},{size:560,itemsPerPage:3},{size:1224,itemsPerPage:4},{size:1824,itemsPerPage:5}],this.responsiveLayoutListenerInterval=100,this.responsiveLayoutDelay=500,this.navigators={keyboard:{enabled:!0,mode:"navigate-page",createInstance:function(t){return new i(t.getConfig().navigators.keyboard)}},drag:{enabled:!0,mode:"navigate-page",overEdgeDragPositionMultiplier:.2,ignoreClickThreshold:10,createInstance:function(t){return new n(t.getConfig().navigators.drag)}},slideshow:{enabled:!1,mode:"navigate-page",interval:3e3,instantRollover:!0,createInstance:function(t){return new r(t.getConfig().navigators.slideshow)}},"interface":{enabled:!1,mode:"navigate-page",createInstance:function(t){return new o(t.getConfig().navigators.slideshow)}}},this.defaultAnimator={defaultAnimationSpeed:4,minAnimationSpeed:1,maxAnimationSpeed:10},this.cssPrefix="flow-carousel-",this.cssClasses={wrap:"wrap",items:"items",scroller:"scroller",item:"item",placeholder:"placeholder",itemHover:"item-hover",matchWrap:"match-wrap",matchLargestItem:"match-largest-item",horizontal:"horizontal",vertical:"vertical",animateTransform:"animate-transform",initiating:"initiating",loading:"loading",rendering:"rendering"},this.dataTarget="flow-carousel",this.dataSource=null,this.renderer=null,this.animator=null,this.getRenderRange=function(t,e,i){return{start:Math.max(t-e,0),end:Math.min(t+2*e-1,i-1)}}}return s.Orientation={HORIZONTAL:"horizontal",VERTICAL:"vertical"},s.SizeMode={MATCH_WRAP:"match-wrap",MATCH_LARGEST_ITEM:"match-largest-item"},s.prototype.extend=function(e){t.extend(!0,this,e)},s.prototype.getItemsPerPage=function(t){var e,i;if(!this.useResponsiveLayout)return this.itemsPerPage;for(e=this.responsiveBreakpoints.length-1;e>=0;e--)if(i=this.responsiveBreakpoints[e],i.size<=t)return i.itemsPerPage;return this.responsiveBreakpoints[0].itemsPerPage},s.prototype.getClassName=function(t){if("undefined"==typeof this.cssClasses[t])throw new Error('Unknown CSS class type "'+t+'" requested');return this.cssPrefix+this.cssClasses[t]},s}),i("AbstractDataSource",[],function(){function t(){}return t.prototype.getItemCount=function(){throw new Error("Not implemented")},t.prototype.isAsynchronous=function(){return!1},t.prototype.getItems=function(t,e){throw new Error("Not implemented")},t.prototype.destroy=function(){},t}),i("ArrayDataSource",["AbstractDataSource","Deferred"],function(t,e){function i(e){t.call(this),this._data=e||[]}return i.prototype=Object.create(t.prototype),i.prototype.setData=function(t){this._data=t},i.prototype.getItemCount=function(){return this._data.length},i.prototype.getItems=function(t,i){var n=new e;if(t="number"==typeof t?t:0,i="number"==typeof i?i:this._data.length-1,0>t)throw new Error('Invalid negative start index "'+t+'" requested');if(i>this._data.length-1)throw new Error('Too large end index "'+i+'" requested, there are only '+this._data.length+" items");return n.resolve(this._data.slice(t,i+1)),n.promise()},i}),i("HtmlDataSource",["jquery","AbstractDataSource","Deferred"],function(t,e,i){function n(t){e.call(this),this._wrap=t,this._data=this._setupData(this._wrap)}return n.prototype=Object.create(e.prototype),n.prototype.getItemCount=function(){return this._data.length},n.prototype.getItems=function(t,e){var n=new i;if(t="number"==typeof t?t:0,e="number"==typeof e?e:this._data.length-1,0>t)throw new Error('Invalid negative start index "'+t+'" requested');if(e>this._data.length-1)throw new Error('Too large end index "'+e+'" requested, there are only '+this._data.length+" items");return n.resolve(this._data.slice(t,e+1)),n.promise()},n.prototype._setupData=function(e){var i=[];return t(e).children().each(function(e,n){i.push(n),t(n).detach()}),i},n}),i("AbstractAnimator",[],function(){function t(t){}return t.prototype.getCurrentPosition=function(){throw new Error("Not implemented")},t.prototype.animateToItem=function(t,e){throw new Error("Not implemented")},t.prototype.animateToPosition=function(t,e,i){throw new Error("Not implemented")},t.prototype.onCarouselElementReady=function(){},t.prototype.destroy=function(){},t}),i("DefaultAnimator",["jquery","AbstractAnimator","Config","Util","Deferred"],function(t,e,i,n,r){function o(t){e.call(this,t),this._carousel=t,this._activeDeferred=null,this._transitionEndListenerCreated=!1,this._isUsingAnimatedTransform=!1,this._eventListeners={transitionEnd:this._onRawTransitionEnd.bind(this)}}return function(){var t,e=0,i=["webkit","moz"];for(t=0;t<i.length&&!window.requestAnimationFrame;++t)window.requestAnimationFrame=window[i[t]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[i[t]+"CancelAnimationFrame"]||window[i[t]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t){var i=(new Date).getTime(),n=Math.max(0,16-(i-e)),r=window.setTimeout(function(){t(i+n)},n);return e=i+n,r}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}(),o.prototype=Object.create(e.prototype),o.prototype.destroy=function(){var e=t(this._carousel.getScrollerWrap());e.off("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",this._eventListeners.transitionEnd)},o.prototype.getCurrentPosition=function(){var e=t(this._carousel.getScrollerWrap()),r=e.css("transform"),o=n.parseTransformMatrix(r),s=this._carousel.getOrientation();return s===i.Orientation.HORIZONTAL?o.x:o.y},o.prototype.animateToItem=function(t,e,i){var n=this._carousel.getItemPositionByIndex(t);return this.animateToPosition(n,e,!1,i)},o.prototype.animateToPosition=function(e,n,o,s){var a=this._carousel.getConfig().defaultAnimator;if(n="boolean"==typeof n?n:!1,o="boolean"==typeof o?o:!1,s="number"==typeof s?s:a.defaultAnimationSpeed,s=Math.min(Math.max(s,a.minAnimationSpeed),a.maxAnimationSpeed),!this._transitionEndListenerCreated&&n!==!0)throw new Error("Requested non-instant animation before transition end listener was created");var h,u,l,d,c=o?null:new r,p=this._carousel.getOrientation(),m=t(this._carousel.getScrollerWrap());return e=Math.floor(e),null!==this._activeDeferred&&(this._activeDeferred.resolve(),this._activeDeferred=null),o!==!0&&(h=this.getCurrentPosition(),u=e-h),l=p===i.Orientation.HORIZONTAL?"translate3d("+e+"px,0,0)":"translate3d(0,"+e+"px,0)",n===!0&&this._isUsingAnimatedTransform?(m.css("transition-duration","0ms"),this._isUsingAnimatedTransform=!1):n===!1&&(d=Math.abs(u)/s,m.css("transition-duration",d+"ms"),this._isUsingAnimatedTransform=!0),n?m.css("transform",l):window.requestAnimationFrame(function(){m.css("transform",l)}),o?void 0:(n||o!==!0&&e===h?c.resolve():(this._activeDeferred=new r,this._activeDeferred.done(function(){this._activeDeferred=null,c.resolve()}.bind(this))),c.promise())},o.prototype.onCarouselElementReady=function(){this._setupTransitionEndListener()},o.prototype._setupTransitionEndListener=function(){var e=t(this._carousel.getScrollerWrap());e.on("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",this._eventListeners.transitionEnd),this._transitionEndListenerCreated=!0},o.prototype._onRawTransitionEnd=function(){this._resolveDeferred()},o.prototype._resolveDeferred=function(){null!==this._activeDeferred&&this._activeDeferred.resolve()},o}),i("ScrollAnimator",["jquery","AbstractAnimator","Config","Deferred"],function(t,e,i,n){function r(t){e.call(this,t),this._animationSpeed=200,this._carousel=t}return function(){var t,e=0,i=["webkit","moz"];for(t=0;t<i.length&&!window.requestAnimationFrame;++t)window.requestAnimationFrame=window[i[t]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[i[t]+"CancelAnimationFrame"]||window[i[t]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t){var i=(new Date).getTime(),n=Math.max(0,16-(i-e)),r=window.setTimeout(function(){t(i+n)},n);return e=i+n,r}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}(),r.prototype=Object.create(e.prototype),r.prototype.onCarouselElementReady=function(){t(this._carousel.getMainWrap()).addClass(this._carousel.getConfig().cssPrefix+"scroll-animator")},r.prototype.getCurrentPosition=function(){var e=t(this._carousel.getItemsWrap()),n=this._carousel.getOrientation();return n===i.Orientation.HORIZONTAL?-1*e.scrollLeft():-1*e.scrollTop()},r.prototype.animateToItem=function(t,e){var i=this._carousel.getItemPositionByIndex(t);return this.animateToPosition(i,e)},r.prototype.animateToPosition=function(t,e,r){e="boolean"==typeof e?e:!1,r="boolean"==typeof r?r:!1;var o=r?null:new n,s=this._carousel.getOrientation();return t=-1*Math.floor(t),s===i.Orientation.HORIZONTAL?this._animateToLeftPosition(t,e).done(function(){r!==!0&&o.resolve()}):this._animateToTopPosition(t,e).done(function(){r!==!0&&o.resolve()}),r!==!0?o.promise():void 0},r.prototype._animateToLeftPosition=function(e,i){var r=t(this._carousel.getItemsWrap()),o=new n;return i===!0?window.requestAnimationFrame(function(){r.scrollLeft(e),o.resolve()}):r.animate({scrollLeft:e},this._animationSpeed,function(){o.resolve()}.bind(this)),o.promise()},r.prototype._animateToTopPosition=function(e,i){var r=t(this._carousel.getItemsWrap()),o=new n;return i===!0?window.requestAnimationFrame(function(){r.scrollTop(e),o.resolve()}):r.animate({scrollTop:e},this._animationSpeed,function(){o.resolve()}.bind(this)),o.promise()},r}),i("AbstractRenderer",["jquery"],function(t){function e(){}return e.prototype.renderItem=function(t,e,i){throw new Error("Not implemented")},e.prototype.renderPlaceholder=function(e,i){return t("<div></div>")[0]},e.prototype.destroyItem=function(e){t(e).remove()},e.prototype.restoreInitialContents=function(t,e){},e.prototype.destroy=function(){},e}),i("HtmlRenderer",["AbstractRenderer","Deferred"],function(t,e){function i(){t.call(this)}return i.prototype=Object.create(t.prototype),i.prototype.renderItem=function(t,i,n){var r=new e;return r.resolve(n),r.promise()},i.prototype.restoreInitialContents=function(t,e){t.getItems().done(function(t){$(t).each(function(t,i){var n=$(i).attr("style");"string"==typeof n&&$(i).attr("style",n.replace("display: block;","")),$(e).append(i)})})},i}),function(){function t(){}function e(t,e){for(var i=t.length;i--;)if(t[i].listener===e)return i;return-1}function n(t){return function(){return this[t].apply(this,arguments)}}var r=t.prototype,o=this,s=o.EventEmitter;r.getListeners=function(t){var e,i,n=this._getEvents();if(t instanceof RegExp){e={};for(i in n)n.hasOwnProperty(i)&&t.test(i)&&(e[i]=n[i])}else e=n[t]||(n[t]=[]);return e},r.flattenListeners=function(t){var e,i=[];for(e=0;e<t.length;e+=1)i.push(t[e].listener);return i},r.getListenersAsObject=function(t){var e,i=this.getListeners(t);return i instanceof Array&&(e={},e[t]=i),e||i},r.addListener=function(t,i){var n,r=this.getListenersAsObject(t),o="object"==typeof i;for(n in r)r.hasOwnProperty(n)&&-1===e(r[n],i)&&r[n].push(o?i:{listener:i,once:!1});return this},r.on=n("addListener"),r.addOnceListener=function(t,e){return this.addListener(t,{listener:e,once:!0})},r.once=n("addOnceListener"),r.defineEvent=function(t){return this.getListeners(t),this},r.defineEvents=function(t){for(var e=0;e<t.length;e+=1)this.defineEvent(t[e]);return this},r.removeListener=function(t,i){var n,r,o=this.getListenersAsObject(t);for(r in o)o.hasOwnProperty(r)&&(n=e(o[r],i),-1!==n&&o[r].splice(n,1));return this},r.off=n("removeListener"),r.addListeners=function(t,e){return this.manipulateListeners(!1,t,e)},r.removeListeners=function(t,e){return this.manipulateListeners(!0,t,e)},r.manipulateListeners=function(t,e,i){var n,r,o=t?this.removeListener:this.addListener,s=t?this.removeListeners:this.addListeners;if("object"!=typeof e||e instanceof RegExp)for(n=i.length;n--;)o.call(this,e,i[n]);else for(n in e)e.hasOwnProperty(n)&&(r=e[n])&&("function"==typeof r?o.call(this,n,r):s.call(this,n,r));return this},r.removeEvent=function(t){var e,i=typeof t,n=this._getEvents();if("string"===i)delete n[t];else if(t instanceof RegExp)for(e in n)n.hasOwnProperty(e)&&t.test(e)&&delete n[e];else delete this._events;return this},r.removeAllListeners=n("removeEvent"),r.emitEvent=function(t,e){var i,n,r,o,s=this.getListenersAsObject(t);for(r in s)if(s.hasOwnProperty(r))for(n=s[r].length;n--;)i=s[r][n],i.once===!0&&this.removeListener(t,i.listener),o=i.listener.apply(this,e||[]),o===this._getOnceReturnValue()&&this.removeListener(t,i.listener);return this},r.trigger=n("emitEvent"),r.emit=function(t){var e=Array.prototype.slice.call(arguments,1);return this.emitEvent(t,e)},r.setOnceReturnValue=function(t){return this._onceReturnValue=t,this},r._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:!0},r._getEvents=function(){return this._events||(this._events={})},t.noConflict=function(){return o.EventEmitter=s,t},"function"==typeof i&&i.amd?i("EventEmitter",[],function(){return t}):"object"==typeof module&&module.exports?module.exports=t:this.EventEmitter=t
}.call(this),i("Exporter",[],function(){return{"export":function(t){"function"==typeof window.define&&window.define.amd&&window.define("FlowCarousel",[],function(){return t}),window.FlowCarousel=t}}}),i("FlowCarousel",["jquery","Config","AbstractDataSource","ArrayDataSource","HtmlDataSource","AbstractAnimator","DefaultAnimator","ScrollAnimator","AbstractRenderer","HtmlRenderer","AbstractNavigator","Deferred","Util","EventEmitter","Exporter"],function(t,e,i,n,r,o,s,a,h,u,l,d,c,p,m){function _(){this.version="0.1.0",this._id=_.instanceCount,this._initiated=!1,this._destroyed=!1,this._config=new e,this._dataSource=null,this._renderer=null,this._animator=null,this._navigators={},this._mainWrap=null,this._itemsWrap=null,this._scrollerWrap=null,this._isAnimating=!1,this._isDragged=!1,this._targetItemIndex=0,this._currentItemIndex=0,this._lastCenterItemIndex=null,this._hoverItemIndex=null,this._renderedItemIndexes=[],this._renderedPlaceholderIndexes=[],this._itemIndexToElementMap={},this._delayedTasks={},this._getItemsPromise=null,this._activeAnimationDeferred=null,this._startupItemsRenderedEmitted=!1,this._lastLargestChildSize=null,this._cache={wrapSize:null,wrapOppositeSize:null},this._eventListeners={onWindowResize:this._onWindowResize.bind(this)},this._emptyCache=c.cloneObj(this._cache),this._useCache=!0,this.Event=_.Event,this.Config=_.Config,_.instanceCount++}return _.prototype=Object.create(p.prototype),_.instanceCount=0,_.liveCount=0,_.Config=e,_.AbstractDataSource=i,_.ArrayDataSource=n,_.HtmlDataSource=r,_.AbstractRenderer=h,_.HtmlRenderer=u,_.AbstractAnimator=o,_.DefaultAnimator=s,_.ScrollAnimator=a,_.AbstractNavigator=l,_.Deferred=d,_.SizeMode={INNER:"inner",OUTER:"outer"},_.Event={INITIATING:"initiating",INITIATED:"initiated",STARTUP_ITEMS_RENDERED:"startup-items-rendered",LOADING_ITEMS:"loading-items",LOADED_ITEMS:"loaded-items",ABORTED_ITEMS:"aborted-items",RENDERED_ITEMS:"rendered-items",DESTROYED_ITEMS:"destroyed-items",NAVIGATING_TO_ITEM:"navigating-to-item",NAVIGATED_TO_ITEM:"navigated-to-item",NAVIGATING_TO_PAGE:"navigating-to-page",NAVIGATED_TO_PAGE:"navigated-to-page",LAYOUT_CHANGED:"layout-changed",DRAG_BEGIN:"drag-begin",DRAG_END:"drag-end"},_.prototype.init=function(t,e){var n=new d;if(this._initiated)throw new Error("The carousel is already initiated");if(this.emit(_.Event.INITIATING),c.isObject(e)&&this._config.extend(e),this._setupElement(t),this._config.dataSource instanceof i||c.isArray(this._config.dataSource))this.setDataSource(this._config.dataSource);else{if("undefined"!=typeof this._config.dataSource&&null!==this._config.dataSource)throw new Error('Unexpected data source type "'+typeof this._config.dataSource+'" provided');null===this._dataSource&&(this._dataSource=new r(this._mainWrap))}if(null!==this._config.renderer){if(!(this._config.renderer instanceof h))throw new Error("Custom renderer provided in config but it's not an instance of AbstractRenderer");this._renderer=this._config.renderer}else if(this._dataSource instanceof r)this._renderer=new u;else if(null===this._renderer)throw new Error('Expecting a custom "renderer" to be defined in the config if not using the HtmlDataSource');if(null!==this._config.animator){if(!(this._config.animator instanceof o))throw new Error("Custom animator provided in config but it's not an instance of AbstractAnimator");this._animator=this._config.animator}else null===this._animator&&(this._animator=new s(this));return this._setupCarousel(this._mainWrap,this._config.orientation),this._setupDefaultNavigators(),this._initiated=!0,_.liveCount++,this.emit(_.Event.INITIATED),this._validateItemsToRender().done(function(){this.validateSize(),n.resolve()}.bind(this)),n.done(function(){this._setupWindowResizeListener()}.bind(this)),n.promise()},_.prototype.destroy=function(){var e,n,r=["isInitiated","isDestroyed"];if(!this._initiated)throw new Error("Unable to destroy carousel that has not been initiated");this._dataSource instanceof i&&this._dataSource.destroy(),this._renderer instanceof h&&this._renderer.destroy(),this._animator instanceof o&&this._animator.destroy();for(e in this._navigators)this._navigators[e]instanceof l&&this._navigators[e].destroy();c.removeElementClassesPrefixedWith(this._mainWrap,this._config.cssPrefix),t(this._mainWrap).empty(),this._renderer.restoreInitialContents(this._dataSource,this._mainWrap),t(this._mainWrap).data(this._config.dataTarget,null),t(window).off("resize",this._eventListeners.onWindowResize),this._config=null,this._dataSource=null,this._renderer=null,this._animator=null,this._navigators={},this._mainWrap=null,this._itemsWrap=null,this._scrollerWrap=null,this._isAnimating=!1,this._targetItemIndex=0,this._currentItemIndex=0,this._hoverItemIndex=null,this._renderedItemIndexes=[],this._renderedPlaceholderIndexes=[],this._itemIndexToElementMap={},this._delayedTasks={},this._getItemsPromise=null,this._activeAnimationDeferred=null,this._startupItemsRenderedEmitted=!1,this._lastLargestChildSize=null,this._cache=c.cloneObj(this._emptyCache),this._useCache=!0;for(n in this)-1===r.indexOf(n)&&"function"==typeof this[n]&&(this[n]=function(){throw new Error('The carousel is destroyed, attempting to call any of its methods results in an error (tried to call "'+this.name+'")')}.bind({name:n}));this._initiated=!1,this._destroyed=!0,_.liveCount--},_.prototype.getId=function(){return this._id},_.prototype.isInitiated=function(){return this._initiated},_.prototype.isDestroyed=function(){return this._destroyed},_.prototype.isAnimating=function(){return this._isAnimating},_.prototype.isDragged=function(){return this._isDragged},_.prototype.getConfig=function(){return this._config},_.prototype.getAnimator=function(){return this._animator},_.prototype.getMainWrap=function(){return this._mainWrap},_.prototype.getItemsWrap=function(){return this._itemsWrap},_.prototype.getScrollerWrap=function(){return this._scrollerWrap},_.prototype.getOrientation=function(){return this._config.orientation},_.prototype.getItemSize=function(){var t=this._getMainWrapSize(),e=this._config.getItemsPerPage(t);return this._calculateItemSize(t,e)},_.prototype.getPageSize=function(){var t=this._getMainWrapSize(),e=this._config.getItemsPerPage(t),i=this._calculateItemSize(t,e);return e*i},_.prototype.getTotalSize=function(){var t=this._getMainWrapSize(),e=this._dataSource.getItemCount(),i=this._config.getItemsPerPage(t),n=this._calculateItemSize(t,i);return e*n},_.prototype.getItemCount=function(){return this._dataSource.getItemCount()},_.prototype.getItemCountOnLastPage=function(){var t=this.getItemCount(),e=this.getItemsPerPage(),i=this.getPageCount();return t-(i-1)*e},_.prototype.getPageCount=function(){return Math.ceil(this._dataSource.getItemCount()/this.getItemsPerPage())},_.prototype.getItemsPerPage=function(){var t=this._getMainWrapSize(),e=this._config.getItemsPerPage(t);return this._cache.itemsPerPage=e,e},_.prototype.getTargetItemIndex=function(){return this._targetItemIndex},_.prototype.getCurrentItemIndex=function(){return this._currentItemIndex},_.prototype.getHoverItemIndex=function(){return this._hoverItemIndex},_.prototype.getCurrentPageIndex=function(){return this.getItemPageIndex(this._currentItemIndex)},_.prototype.getItemPageIndex=function(t){var e=this.getItemsPerPage();return Math.floor(t/e)},_.prototype.getCurrentItemPosition=function(){return this._animator.getCurrentPosition()},_.prototype.getItemPositionByIndex=function(t){var e=this.getItemSize(),i=this.getItemsPerPage(),n=this._config.margin,r=n*(i-1)/i;return-Math.floor(t*e+t*(n-r))},_.prototype.getClosestItemIndexAtPosition=function(t,e){e=e||1;var i,n=this.getItemSize(),r=this.getItemCount(),o=this.getItemsPerPage(),s=this._config.margin,a=s*(o-1)/o,h=-t/(n+(s-a));return i=0>e?Math.ceil(h):Math.floor(h),Math.min(Math.max(i,0),r-o)},_.prototype.getClosestPageIndexAtPosition=function(t,e){e=e||1;var i,n=this.getClosestItemIndexAtPosition(t,e),r=this.getItemsPerPage(),o=this.getPageCount(),s=n/r;return i=0>e?Math.ceil(s):Math.floor(s),Math.min(Math.max(i,0),o-1)},_.prototype.getRenderRange=function(t){t=t||this._currentItemIndex;var e=this.getItemsPerPage(),i=this._dataSource.getItemCount();return this._config.getRenderRange(t,e,i)},_.prototype.getRenderedRange=function(){var t,e,i={start:null,end:null};for(e=0;e<this._renderedItemIndexes.length;e++)t=this._renderedItemIndexes[e],t=parseInt(t,10),(null===i.start||t<i.start)&&(i.start=t),(null===i.end||t>i.end)&&(i.end=t);return null===i.start||null===i.end?null:i},_.prototype.isAnimating=function(){return this._isAnimating},_.prototype.setDataSource=function(t){if(t instanceof i)this._dataSource=t;else{if(!c.isArray(t))throw new Error('Invalid data of type "'+typeof t+'" provided, expected an instance of AbstractDataSource or a simple array');this._dataSource=new n(t)}return this},_.prototype.setRenderer=function(t){if(!(t instanceof h))throw new Error("Invalid renderer provided, expected an instance of AbstractRenderer");return this._renderer=t,this},_.prototype.addNavigator=function(t,e){if("undefined"!=typeof this._navigators[t])throw new Error('Navigator of type "'+t+'" already added');if(!(e instanceof l))throw new Error("The navigator is expected to be an instance of AbstractNavigator");this._navigators[t]=e,this._navigators[t].init(this)},_.prototype.getNavigatorByType=function(t){return"undefined"==typeof this._navigators[t]?null:this._navigators[t]},_.prototype.getDataSource=function(){return this._dataSource},_.prototype.navigateToItem=function(t,e,i,n){e="boolean"==typeof e?e:!1,i="boolean"==typeof i?i:!1;var r=new d,o=this._dataSource.getItemCount(),s=t===this._currentItemIndex,a=this.getItemsPerPage(),h=this.getCurrentItemIndex(),u=Math.min(h+1,o-a);if(0===o)return r.resolve(),r.promise();if(0>t)throw new Error('Invalid negative  index "'+t+'" requested');if(t>o-1)throw new Error('Too large index "'+t+'" requested, there are only '+o+" items");if(this._isAnimating){if(null===this._activeAnimationDeferred)throw new Error("Carousel is animating but no active animation deferred is present, this should not happen");return this._activeAnimationDeferred}return s&&i!==!0?(0===t||this.isLastPage()&&t===u?(this._showLimit(t).done(function(){r.resolve()}),this._activeAnimationDeferred=r):r.resolve(),r.promise()):(this._isAnimating=!0,this._targetItemIndex=t,this._animator.animateToItem(t,e,n).done(function(){r.resolve()}),this.emit(_.Event.NAVIGATING_TO_ITEM,t,e),this._config.usePlaceholders&&this._dataSource.isAsynchronous()&&this._renderTargetIndexPlaceholders(),r.done(function(){this._currentItemIndex=this._targetItemIndex,this._lastCenterItemIndex=this.getCurrentCenterItemIndex(),this._isAnimating=!1,this._activeAnimationDeferred=null,this._destroyInvalidItems(),this._validateItemsToRender().done(function(){this.validateSize()}.bind(this)),this.emit(_.Event.NAVIGATED_TO_ITEM,t,e)}.bind(this)),this._activeAnimationDeferred=r,r.promise())},_.prototype.navigateToPage=function(t,e,i,n){e="boolean"==typeof e?e:!1;var r=this.getCurrentPageIndex(),o=t*this.getItemsPerPage(),s=this.getPageCount(),a=new d;return t===r&&i!==!0?((0===t||t===s-1)&&this.getPageCount()>1?(this._showLimit(o).done(function(){a.resolve()}),this._activeAnimationDeferred=a):a.resolve(),a.promise()):(this.emit(_.Event.NAVIGATING_TO_PAGE,t,e),this.navigateToItem(o,e,i,n).done(function(){a.resolve()}),a.done(function(){this.emit(_.Event.NAVIGATED_TO_PAGE,t,e)}.bind(this)),a.promise())},_.prototype.navigateToNextItem=function(t){var e=this.getCurrentItemIndex(),i=this.getMaximumValidItemIndex(),n=Math.min(e+1,i);return this.navigateToItem(n,t)},_.prototype.getMaximumValidItemIndex=function(){var t=this.getItemsPerPage(),e=this.getItemCount();return Math.max(e-t,0)},_.prototype.navigateToPreviousItem=function(t){var e=this.getCurrentItemIndex(),i=Math.max(e-1,0);return this.navigateToItem(i,t)},_.prototype.isFirstItem=function(t){return t="number"==typeof t?t:this.getCurrentPageIndex(),0===t},_.prototype.isLastItem=function(t){return t="number"==typeof t?t:this.getCurrentItemIndex(),0===this.getItemCount()||t>=this.getMaximumValidItemIndex()},_.prototype.isFirstPage=function(t){return t="number"==typeof t?t:this.getCurrentPageIndex(),0===t},_.prototype.isLastPage=function(t){return t="number"==typeof t?t:this.getCurrentPageIndex(),0===this.getPageCount()||t===this.getPageCount()-1},_.prototype.navigateToNextPage=function(t){var e=this.getCurrentPageIndex(),i=this.getPageCount(),n=Math.min(e+1,i-1);return this.navigateToPage(n,t)},_.prototype.navigateToPreviousPage=function(t){var e=this.getCurrentPageIndex(),i=Math.max(e-1,0);return this.navigateToPage(i,t)},_.prototype.getCurrentPageVisibleRange=function(){var t=this.getItemsPerPage(),e=this.getItemCount();return{start:this._currentItemIndex,end:Math.max(Math.min(this._currentItemIndex+t-1,e-1),0)}},_.prototype.getCurrentPageVisibleItemElements=function(){var t,e,i=this.getItemCount(),n=this.getCurrentPageVisibleRange(),r=[];if(0===i)return[];for(e=n.start;e<=n.end;e++){if(t=this.getItemElementByIndex(e),null===t)throw new Error("Requested item element at index #"+e+" not found, this should not happen");r.push(t)}return r},_.prototype.getItemElementByIndex=function(t){var e=this.getItemCount();if(0===e)return null;if(0>t)throw new Error('Invalid negative  index "'+t+'" requested');if(t>e-1)throw new Error('Too large index "'+t+'" requested, there are only '+e+" items");return"undefined"==typeof this._itemIndexToElementMap[t]?null:this._itemIndexToElementMap[t]},_.prototype.redraw=function(){return this._reLayout()},_.prototype.calculateCenteredItemStartIndex=function(t,e){e="boolean"==typeof e?e:!1;var i=this.getMaximumValidItemIndex(),n=this.getItemsPerPage(),r=n%2===0,o=e?1:-1,s=e?"floor":"ceil",a=Math[s](t+o*n/2);return r&&(a-=1),Math.max(Math.min(a,i),0)},_.prototype.getCurrentCenterItemIndex=function(){return this.calculateCenteredItemStartIndex(this._currentItemIndex,!0)},_.prototype._setupElement=function(e){var i,n,r=t(e);if(0===r.length)throw new Error('Selector "'+i+'" did not match any elements');if(r.length>1)throw new Error('Selector "'+i+'" matches more then one element, try using "'+i+':first"');if(i=r[0],n=t(i).data(this._config.dataTarget),n instanceof _)throw new Error('Element matching selector "'+i+'" is already a carousel component, destroy the existing one first');this._mainWrap=i,t(this._mainWrap).data(this._config.dataTarget,this)},_.prototype._setupCarousel=function(i,n){var r,o,s=t(i),a={wrap:this._config.getClassName("wrap"),items:this._config.getClassName("items"),item:this._config.getClassName("item"),scroller:this._config.getClassName("scroller"),matchWrap:this._config.getClassName("matchWrap"),matchLargestItem:this._config.getClassName("matchLargestItem"),initiating:this._config.getClassName("initiating"),horizontal:this._config.getClassName("horizontal"),vertical:this._config.getClassName("vertical")},h=this._config.sizeMode,u=0;if(s.empty(),r=t("<div></div>",{"class":a.items}),o=t("<div></div>",{"class":a.scroller}),h===e.SizeMode.MATCH_WRAP)t(this._mainWrap).addClass(a.matchWrap);else{if(h!==e.SizeMode.MATCH_LARGEST_ITEM)throw new Error('Invalid size mode "'+h+'" defined');t(this._mainWrap).addClass(a.matchLargestItem)}if(r.append(o),s.append(r),this._itemsWrap=r[0],this._scrollerWrap=o[0],s.addClass(a.wrap),s.addClass(a.initiating),n===e.Orientation.HORIZONTAL)s.addClass(a.horizontal);else{if(n!==e.Orientation.VERTICAL)throw new Error('Unexpected orientation "'+n+'" provided');s.addClass(a.vertical)}if(null!==this._config.startItemIndex?u=this._config.startItemIndex:null!==this._config.startPageIndex&&(u=this._config.startPageIndex*this.getItemsPerPage()),this._animator.onCarouselElementReady(),this._setupLayout(u,this._config.animateToStartIndex,this._config.centerStartItemIndex),s.removeClass(a.initiating),null!==this._config.startItemIndex&&null!==this._config.startPageIndex)throw new Error("Set either the startItemIndex or startPageIndex option but not both")},_.prototype._setupLayout=function(i,n,r){var o=this._config.orientation,s=this._getMainWrapSize(),a=this._dataSource.getItemCount(),h=this._config.getItemsPerPage(s),u=this._calculateItemSize(s,h),l=Math.ceil(a*u),d=n!==!0,c=o===e.Orientation.HORIZONTAL?"width":"height";0!==s&&(t(this._scrollerWrap).css(c,l),"number"==typeof i&&0!==i&&(r&&(i=this.calculateCenteredItemStartIndex(i)),this._targetItemIndex=i,this._currentItemIndex=i,this._lastCenterItemIndex=this.getCurrentCenterItemIndex(),this.emit(_.Event.NAVIGATING_TO_ITEM,i,d),this._animator.animateToItem(i,d,!0).done(function(){this.emit(_.Event.NAVIGATED_TO_ITEM,i,d)}.bind(this))),this._config.usePlaceholders&&this._dataSource.isAsynchronous()&&this._renderTargetIndexPlaceholders(),this.emit(_.Event.LAYOUT_CHANGED))},_.prototype._setupDefaultNavigators=function(){var t;for(t in this._config.navigators){if("function"!=typeof this._config.navigators[t].createInstance)throw new Error('Expected the navigator definition to include "createInstance" method that returns a deferred promise that is resolved with a new instance of the given navigator');this._config.navigators[t].enabled&&d.when(this._config.navigators[t].createInstance(this)).done(function(t){null===this.carousel||this.carousel.isDestroyed()||this.carousel.addNavigator(this.type,t)}.bind({carousel:this,type:t}))}},_.prototype._validateItemsToRender=function(){var t=this.getRenderRange();return this._renderItemRange(t.start,t.end)},_.prototype._destroyInvalidItems=function(){var t,e,i,n=this.getRenderRange(),r=[],o=[],s=[];for(i=0;i<this._renderedPlaceholderIndexes.length;i++)if(t=this._renderedPlaceholderIndexes[i],t<n.start||t>n.end){if(e=this.getItemElementByIndex(t),null===e)throw new Error("Placeholder element at index #"+t+" not found, this should not happen");this._destroyItem(e,t),s.push(t)}else r.push(t);for(this._renderedPlaceholderIndexes=r,i=0;i<this._renderedItemIndexes.length;i++)if(t=this._renderedItemIndexes[i],t<n.start||t>n.end){if(e=this.getItemElementByIndex(t),null===e)throw new Error("Item element at index #"+t+" not found, this should not happen");this._destroyItem(e,t),s.push(t)}else o.push(t);s.length>0&&this.emit(_.Event.DESTROYED_ITEMS,s),this._renderedItemIndexes=o},_.prototype._destroyItem=function(t,e){this._renderer.destroyItem(t),this._removeItemIndexToElement(e)},_.prototype._renderTargetIndexPlaceholders=function(){var t=this._targetItemIndex,e=this.getRenderRange(t);this._renderItemPlaceholders(e.start,e.end)},_.prototype._renderItemPlaceholders=function(t,e){var i,n,r=[];for(n=t;e>=n;n++)-1!==this._renderedItemIndexes.indexOf(n)?r.push(null):(i=this._renderer.renderPlaceholder(this._config,n),r.push(i));this._insertRenderedElements(r,t,!0)},_.prototype._renderItemRange=function(e,i){var n,r=this,o=new d,s=this._config.getClassName("loading"),a=this.getRenderedRange(),h=null===a||e>=a.start?1:-1;return null!==a&&a.start===e&&a.end===i?(o.resolve(),o.promise()):(n=null===a?{start:e,end:i}:1===h?{start:Math.max(e,a.end+1),end:i}:{start:e,end:Math.min(i,a.start-1)},this._dataSource.isAsynchronous()&&t(this._mainWrap).addClass(s),null!==this._getItemsPromise&&("function"==typeof this._getItemsPromise.abort&&this._getItemsPromise.abort(),this._getItemsPromise._ignore=!0,this._getItemsPromise=null),this.emit(_.Event.LOADING_ITEMS,n.start,n.end),this._getItemsPromise=this._dataSource.getItems(n.start,n.end).done(function(e){if(r._initiated){if(this._ignore===!0)return void r.emit(_.Event.ABORTED_ITEMS,n.start,n.end,e);r.emit(_.Event.LOADED_ITEMS,n.start,n.end,e),r._getItemsPromise=null,r._dataSource.isAsynchronous()&&t(r._mainWrap).removeClass(s),r._renderItems(e,n.start).done(function(){this._startupItemsRenderedEmitted||(this.emit(_.Event.STARTUP_ITEMS_RENDERED),this._startupItemsRenderedEmitted=!0),o.resolve()}.bind(r))}}),o.promise())},_.prototype._renderItems=function(e,i){var n,r,o,s,a,h,u,l=new d,c=this.getRenderRange(),p=this._config.getClassName("rendering"),m=i+e.length-1,g=[];if(0===t(this._mainWrap).parent().length)return l.resolve(),l.promise();for(u=0;u<e.length;u++)o=e[u],r=i+u,n=r<c.start||r>c.end,n&&(a=this._itemIndexToElementMap[r],"undefined"!=typeof a&&(this._renderer.destroyItem(a),this._removeItemIndexToElement(r),h=this._renderedPlaceholderIndexes.indexOf(r),-1!==h&&this._renderedPlaceholderIndexes.splice(h,1))),s=-1!==this._renderedItemIndexes.indexOf(r)||n?null:this._renderer.renderItem(this._config,r,o),g.push(s);return t(this._mainWrap).addClass(p),d.when.apply(t,g).done(function(){if(!this._initiated)throw new Error("Carousel was destroyed before rendering items");t(this._mainWrap).removeClass(p),this._insertRenderedElements(arguments,i),this.emit(_.Event.RENDERED_ITEMS,i,m,arguments),l.resolve()}.bind(this)),l.promise()},_.prototype._insertRenderedElements=function(e,i,n){var r,o,s,a,h="function"==typeof document.createDocumentFragment,u=h?t(document.createDocumentFragment()):null,l=h?u:t(this._scrollerWrap);if(0!==t(this._mainWrap).parent().length){for(a=0;a<e.length;a++)null!==e[a]&&(r=i+a,n?-1===this._renderedPlaceholderIndexes.indexOf(r)&&(this._insertRenderedElement(l,e[a],r,!0),this._renderedPlaceholderIndexes.push(r)):(o=this._renderedPlaceholderIndexes.indexOf(r),-1!==o&&"undefined"!=typeof this._itemIndexToElementMap[r]&&(s=this._itemIndexToElementMap[r],this._renderer.destroyItem(s),this._removeItemIndexToElement(r),this._renderedPlaceholderIndexes.splice(o,1)),this._insertRenderedElement(l,e[a],r),this._renderedItemIndexes.push(r)));h&&t(this._scrollerWrap).append(u)}},_.prototype._insertRenderedElement=function(i,n,r,o){var s,a=t(n),h=this._config.orientation,u=this._config.sizeMode,l=this._getMainWrapSize(),d=this._getMainWrapOppositeSize(),c=this._config.getItemsPerPage(l),p=this._calculateItemSize(l,c),m=this._config.margin,_=m*(c-1)/c,g=Math.ceil(p-_),f=Math.floor(r*p+r*(m-_)),v=t("<div></div>"),I={};if(u==e.SizeMode.MATCH_WRAP&&0===d&&this._initiated)throw new Error("The wrap opposite size was calculated to be zero, this should not happen");if(h===e.Orientation.HORIZONTAL?(I.width=g,I.left=f,u==e.SizeMode.MATCH_WRAP&&(I.height=d)):h===e.Orientation.VERTICAL&&(I.height=g,I.top=f,u==e.SizeMode.MATCH_WRAP&&(I.width=d)),a.css("display","block"),s=a.wrap(v).parent(),s.css(I),s.addClass(this._config.getClassName("item")),o&&s.addClass(this._config.getClassName("placeholder")),this._preprocessItemElement(s,r),i.append(s),"undefined"!=typeof this._itemIndexToElementMap[r])throw new Error("Element at index #"+r+" already exists, this should not happen");this._mapItemIndexToElement(r,s[0])},_.prototype._mapItemIndexToElement=function(t,e){this._itemIndexToElementMap[t]=e},_.prototype._removeItemIndexToElement=function(t){delete this._itemIndexToElementMap[t]},_.prototype._preprocessItemElement=function(e,i){var n=this;e.data(this._config.cssPrefix+"index",i),e.hover(function(){var e=t(this).data(n._config.cssPrefix+"index");n._hoverItemIndex=e},function(){n._hoverItemIndex=null})},_.prototype.validateSize=function(){if(this._config.sizeMode===e.SizeMode.MATCH_LARGEST_ITEM){var i=this._getOppositeOrientation(this._config.orientation),n=this._config.orientation===e.Orientation.HORIZONTAL?"height":"width",r=this.getCurrentPageVisibleItemElements(),o=this._getLargestElementSize(r,i,_.SizeMode.OUTER);return o>0&&o!==this._lastLargestChildSize?(t(this._scrollerWrap).css(n,Math.ceil(o)+"px"),this._lastLargestChildSize=o,!0):!1}},_.prototype._reLayout=function(){var t,e;return t=this._config.centerStartItemIndex?this._lastCenterItemIndex:this._currentItemIndex,this._reset(),this._setupLayout(t,!1,this._config.centerStartItemIndex),e=this._validateItemsToRender(),e.done(function(){this.validateSize()}.bind(this)),e},_.prototype._reset=function(){var e=t(this._scrollerWrap);e.empty().attr("style",null).data(this._config.cssPrefix+"last-size",null),this._itemIndexToElementMap={},this._isAnimating=!1,this._targetItemIndex=0,this._currentItemIndex=0,this._lastCenterItemIndex=null,this._lastLargestChildSize=null,this._renderedItemIndexes=[],this._renderedPlaceholderIndexes=[],this._itemIndexToElementMap={},this._cache=c.cloneObj(this._emptyCache)},_.prototype._setupWindowResizeListener=function(){t(window).on("resize",this._eventListeners.onWindowResize)},_.prototype._onWindowResize=function(){this._initiated&&this._validateResponsiveLayout()},_.prototype._validateResponsiveLayout=function(e){if(this._isAnimating&&e!==!0)return!1;var i=t(this._mainWrap),n=i.data(this._config.cssPrefix+"last-size")||null,r=this._getMainWrapSize(!0);return i.data(this._config.cssPrefix+"last-size",r),null===n||r!==n&&0!==r?(this._performDelayed("re-layout",function(){this._reLayout()}.bind(this),this._config.responsiveLayoutDelay),!0):!1},_.prototype._showLimit=function(t){var e,i,n,r=new d,o=30;return this._isAnimating?r.resolve():(i=0===t?-1:1,e=this.getItemPositionByIndex(t),n=-1===i?e+o:e-o,this._isAnimating=!0,this._animator.animateToPosition(n).done(function(){this._animator.animateToPosition(e).done(function(){this._isAnimating=!1,r.resolve()}.bind(this))}.bind(this))),r.promise()},_.prototype._calculateItemSize=function(t,e){return t/e},_.prototype._getElementSize=function(i,n,r){r=r||_.SizeMode.INNER;var o=r===_.SizeMode.INNER?["innerWidth","innerHeight"]:["outerWidth","outerHeight"];if(n===e.Orientation.HORIZONTAL)return t(i)[o[0]]();if(n===e.Orientation.VERTICAL)return t(i)[o[1]]();throw new Error('Invalid orientation "'+n+'" requested')},_.prototype._getLargestElementSize=function(e,i,n){var r,o,s,a=0;return t(e).each(function(e,h){r=t(h).children(),o=r.length>0?r[0]:h,s=this._getElementSize(o,i,n),s>a&&(a=s)}.bind(this)),a},_.prototype._getMainWrapSize=function(e){if(this._useCache&&null!==this._cache.wrapSize&&e!==!0)return this._cache.wrapSize;var i=this._config.orientation;return this._cache.wrapSize=this._getElementSize(this._mainWrap,i),t(this._mainWrap).data(this._config.cssPrefix+"last-size",this._cache.wrapSize),this._cache.wrapSize},_.prototype._getMainWrapOppositeSize=function(t){if(this._useCache&&null!==this._cache.wrapOppositeSize&&t!==!0)return this._cache.wrapOppositeSize;var e=this._config.orientation,i=this._getOppositeOrientation(e);return this._cache.wrapOppositeSize=this._getElementSize(this._mainWrap,i),this._cache.wrapOppositeSize},_.prototype._getOppositeOrientation=function(t){return t===e.Orientation.HORIZONTAL?e.Orientation.VERTICAL:e.Orientation.HORIZONTAL},_.prototype._onDragBegin=function(t,e,i){this._dragging=!0,this.emit(_.Event.DRAG_BEGIN,t,e,i)},_.prototype._onDragEnd=function(t,e,i,n,r,o,s){this._dragging=!1,this.emit(_.Event.DRAG_END,t,e,i,r,n,o,s)},_.prototype._performDelayed=function(t,e,i){i=i||1e3,"undefined"!=typeof this._delayedTasks[t]&&null!==this._delayedTasks[t]&&(window.clearTimeout(this._delayedTasks[t]),this._delayedTasks[t]=null),this._delayedTasks[t]=window.setTimeout(function(){this._delayedTasks[t]=null,e.apply(e,[t,i])}.bind(this),i)},m.export(_),_}),e("FlowCarousel")});
//# sourceMappingURL=FlowCarousel.min.js.map