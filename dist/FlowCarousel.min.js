!function(t,e){"function"==typeof define&&define.amd?define([],e):t.FlowCarousel=e()}(this,function(){var t,e,i;return function(n){function r(t,e){return y.call(t,e)}function o(t,e){var i,n,r,o,s,a,h,u,d,l,c,p=e&&e.split("/"),f=v.map,_=f&&f["*"]||{};if(t&&"."===t.charAt(0))if(e){for(p=p.slice(0,p.length-1),t=t.split("/"),s=t.length-1,v.nodeIdCompat&&w.test(t[s])&&(t[s]=t[s].replace(w,"")),t=p.concat(t),d=0;d<t.length;d+=1)if(c=t[d],"."===c)t.splice(d,1),d-=1;else if(".."===c){if(1===d&&(".."===t[2]||".."===t[0]))break;d>0&&(t.splice(d-1,2),d-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((p||_)&&f){for(i=t.split("/"),d=i.length;d>0;d-=1){if(n=i.slice(0,d).join("/"),p)for(l=p.length;l>0;l-=1)if(r=f[p.slice(0,l).join("/")],r&&(r=r[n])){o=r,a=d;break}if(o)break;!h&&_&&_[n]&&(h=_[n],u=d)}!o&&h&&(o=h,a=u),o&&(i.splice(0,a,o),t=i.join("/"))}return t}function s(t,e){return function(){return p.apply(n,E.call(arguments,0).concat([t,e]))}}function a(t){return function(e){return o(e,t)}}function h(t){return function(e){m[t]=e}}function u(t){if(r(g,t)){var e=g[t];delete g[t],I[t]=!0,c.apply(n,e)}if(!r(m,t)&&!r(I,t))throw new Error("No "+t);return m[t]}function d(t){var e,i=t?t.indexOf("!"):-1;return i>-1&&(e=t.substring(0,i),t=t.substring(i+1,t.length)),[e,t]}function l(t){return function(){return v&&v.config&&v.config[t]||{}}}var c,p,f,_,m={},g={},v={},I={},y=Object.prototype.hasOwnProperty,E=[].slice,w=/\.js$/;f=function(t,e){var i,n=d(t),r=n[0];return t=n[1],r&&(r=o(r,e),i=u(r)),r?t=i&&i.normalize?i.normalize(t,a(e)):o(t,e):(t=o(t,e),n=d(t),r=n[0],t=n[1],r&&(i=u(r))),{f:r?r+"!"+t:t,n:t,pr:r,p:i}},_={require:function(t){return s(t)},exports:function(t){var e=m[t];return"undefined"!=typeof e?e:m[t]={}},module:function(t){return{id:t,uri:"",exports:m[t],config:l(t)}}},c=function(t,e,i,o){var a,d,l,c,p,v,y=[],E=typeof i;if(o=o||t,"undefined"===E||"function"===E){for(e=!e.length&&i.length?["require","exports","module"]:e,p=0;p<e.length;p+=1)if(c=f(e[p],o),d=c.f,"require"===d)y[p]=_.require(t);else if("exports"===d)y[p]=_.exports(t),v=!0;else if("module"===d)a=y[p]=_.module(t);else if(r(m,d)||r(g,d)||r(I,d))y[p]=u(d);else{if(!c.p)throw new Error(t+" missing "+d);c.p.load(c.n,s(o,!0),h(d),{}),y[p]=m[d]}l=i?i.apply(m[t],y):void 0,t&&(a&&a.exports!==n&&a.exports!==m[t]?m[t]=a.exports:l===n&&v||(m[t]=l))}else t&&(m[t]=i)},t=e=p=function(t,e,i,r,o){if("string"==typeof t)return _[t]?_[t](e):u(f(t,e).f);if(!t.splice){if(v=t,v.deps&&p(v.deps,v.callback),!e)return;e.splice?(t=e,e=i,i=null):t=n}return e=e||function(){},"function"==typeof i&&(i=r,r=o),r?c(n,t,e,i):setTimeout(function(){c(n,t,e,i)},4),p},p.config=function(t){return p(t)},t._defined=m,i=function(t,e,i){e.splice||(i=e,e=[]),r(m,t)||r(g,t)||(g[t]=[t,e,i])},i.amd={jQuery:!0}}(),i("almond",function(){}),i("jquery",["jquery"],function(){return window.jQuery}),i("Config",[],function(){function t(){this.orientation=t.Orientation.HORIZONTAL,this.sizeMode=t.SizeMode.MATCH_WRAP,this.margin=0,this.usePlaceholders=!0,this.useResponsiveLayout=!0,this.itemsPerPage=5,this.startItemIndex=null,this.startPageIndex=null,this.animateToStartIndex=!1,this.responsiveBreakpoints=[{size:0,itemsPerPage:1},{size:320,itemsPerPage:2},{size:560,itemsPerPage:3},{size:1224,itemsPerPage:4},{size:1824,itemsPerPage:5}],this.responsiveLayoutListenerInterval=100,this.responsiveLayoutDelay=500,this.navigators=[t.Navigator.KEYBOARD,t.Navigator.DRAG],this.keyboardNavigatorMode="navigate-page",this.dragNavigatorMode="navigate-page",this.dragNavigatorOverEdgeDragPositionMultiplier=.2,this.dragNavigatorIgnoreClickThreshold=10,this.cssPrefix="flow-carousel-",this.cssClasses={wrap:"wrap",items:"items",scroller:"scroller",item:"item",placeholder:"placeholder",itemHover:"item-hover",matchWrap:"match-wrap",matchLargestItem:"match-largest-item",horizontal:"horizontal",vertical:"vertical",animateTransform:"animate-transform",initiating:"initiating",loading:"loading",rendering:"rendering"},this.dataTarget="flow-carousel",this.dataSource=null,this.renderer=null,this.animator=null,this.getRenderRange=function(t,e,i){return{start:Math.max(t-e,0),end:Math.min(t+2*e-1,i-1)}}}return t.Orientation={HORIZONTAL:"horizontal",VERTICAL:"vertical"},t.SizeMode={MATCH_WRAP:"match-wrap",MATCH_LARGEST_ITEM:"match-largest-item"},t.Navigator={KEYBOARD:"keyboard",DRAG:"drag"},t.prototype.extend=function(t){var e,i;for(e in t){if(i=t[e],"undefined"==typeof this[e])throw new Error('user configuration contains unknown "'+e+'" property');this[e]=i}},t.prototype.getItemsPerPage=function(t){var e,i;if(!this.useResponsiveLayout)return this.itemsPerPage;for(e=this.responsiveBreakpoints.length-1;e>=0;e--)if(i=this.responsiveBreakpoints[e],i.size<=t)return i.itemsPerPage;return this.responsiveBreakpoints[0].itemsPerPage},t.prototype.getClassName=function(t){if("undefined"==typeof this.cssClasses[t])throw new Error('Unknown CSS class type "'+t+'" requested');return this.cssPrefix+this.cssClasses[t]},t}),i("AbstractDataSource",[],function(){function t(){}return t.prototype.getItemCount=function(){throw new Error("Not implemented")},t.prototype.isAsynchronous=function(){return!1},t.prototype.getItems=function(t,e){throw new Error("Not implemented")},t.prototype.destroy=function(){},t}),i("Deferred",["jquery"],function(t){var e=t.Deferred;return e.when=t.when,e}),i("ArrayDataSource",["AbstractDataSource","Deferred"],function(t,e){function i(e){t.call(this),this._data=e||[]}return i.prototype=Object.create(t.prototype),i.prototype.setData=function(t){this._data=t},i.prototype.getItemCount=function(){return this._data.length},i.prototype.getItems=function(t,i){var n=new e;if(t="number"==typeof t?t:0,i="number"==typeof i?i:this._data.length-1,0>t)throw new Error('Invalid negative start index "'+t+'" requested');if(i>this._data.length-1)throw new Error('Too large end index "'+i+'" requested, there are only '+this._data.length+" items");return n.resolve(this._data.slice(t,i+1)),n.promise()},i}),i("HtmlDataSource",["jquery","AbstractDataSource","Deferred"],function(t,e,i){function n(t){e.call(this),this._wrap=t,this._data=this._setupData(this._wrap)}return n.prototype=Object.create(e.prototype),n.prototype.getItemCount=function(){return this._data.length},n.prototype.getItems=function(t,e){var n=new i;if(t="number"==typeof t?t:0,e="number"==typeof e?e:this._data.length-1,0>t)throw new Error('Invalid negative start index "'+t+'" requested');if(e>this._data.length-1)throw new Error('Too large end index "'+e+'" requested, there are only '+this._data.length+" items");return n.resolve(this._data.slice(t,e+1)),n.promise()},n.prototype._setupData=function(e){var i=[];return t(e).children().each(function(e,n){i.push(n),t(n).detach()}),i},n}),i("AbstractAnimator",[],function(){function t(t){}return t.prototype.getCurrentPosition=function(){throw new Error("Not implemented")},t.prototype.animateToItem=function(t,e){throw new Error("Not implemented")},t.prototype.animateToPosition=function(t,e,i){throw new Error("Not implemented")},t.prototype.onCarouselElementReady=function(){},t.prototype.destroy=function(){},t}),i("Util",[],function(){return{isObject:function(t){return"object"==typeof t&&null!==t},isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},objectHasValue:function(t,e){var i;for(i in t)if(t.hasOwnProperty(i)&&t[i]===e)return!0;return!1},parseTransformMatrix:function(t){var e,i,n,r,o,s;if("matrix3d"===t.substring(0,8))e=9,i=[12,13];else if("matrix"===t.substring(0,6))e=7,i=[4,5];else{if("translate3d"!==t.substring(0,11))throw new Error('Unsupported matrix format "'+t+'"');e=12,i=[0,1]}return n=t.substr(e).substr(0,t.length-e-1),r=n.replace(/ +/g,""),o=r.split(/,/),s={x:parseInt(o[i[0]],10),y:parseInt(o[i[1]],10)}},removeElementClassesPrefixedWith:function(t,e){var i,n=$(t).prop("class").split(" "),r=[];for(i=0;i<n.length;i++)n[i].substr(0,e.length)!==e&&r.push(n[i]);$(t).prop("class",r.join(" "))},cloneObj:function(t){return JSON.parse(JSON.stringify(t))}}}),i("DefaultAnimator",["jquery","AbstractAnimator","Config","Util","Deferred"],function(t,e,i,n,r){function o(t){e.call(this,t),this._carousel=t,this._activeDeferred=null,this._transitionEndListenerCreated=!1,this._eventListeners={transitionEnd:this._onRawTransitionEnd.bind(this)}}return function(){var t,e=0,i=["webkit","moz"];for(t=0;t<i.length&&!window.requestAnimationFrame;++t)window.requestAnimationFrame=window[i[t]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[i[t]+"CancelAnimationFrame"]||window[i[t]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t){var i=(new Date).getTime(),n=Math.max(0,16-(i-e)),r=window.setTimeout(function(){t(i+n)},n);return e=i+n,r}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}(),o.prototype=Object.create(e.prototype),e.prototype.destroy=function(){var e=t(this._carousel.getScrollerWrap());e.off("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",this._eventListeners.transitionEnd)},o.prototype.getCurrentPosition=function(){var e=t(this._carousel.getScrollerWrap()),r=e.css("transform"),o=n.parseTransformMatrix(r),s=this._carousel.getOrientation();return s===i.Orientation.HORIZONTAL?o.x:o.y},o.prototype.animateToItem=function(t,e){var i=this._carousel.getItemPositionByIndex(t);return this.animateToPosition(i,e)},o.prototype.animateToPosition=function(e,n,o){if(n="boolean"==typeof n?n:!1,o="boolean"==typeof o?o:!1,!this._transitionEndListenerCreated&&n!==!0)throw new Error("Requested non-instant animation before transition end listener was created");var s,a,h=o?null:new r,u=this._carousel.getOrientation(),d=t(this._carousel.getScrollerWrap()),l=this._carousel.getConfig().getClassName("animateTransform");return e=Math.floor(e),null!==this._activeDeferred&&(this._activeDeferred.resolve(),this._activeDeferred=null),o!==!0&&(s=this.getCurrentPosition()),a=u===i.Orientation.HORIZONTAL?"translate3d("+e+"px,0,0)":"translate3d(0,"+e+"px,0)",n===!0&&d.hasClass(l)?d.removeClass(l):n!==!1||d.hasClass(l)||d.addClass(l),window.requestAnimationFrame(function(){d.css("transform",a)}),o?void 0:(n||o!==!0&&e===s?h.resolve():(this._activeDeferred=new r,this._activeDeferred.done(function(){this._activeDeferred=null,h.resolve()}.bind(this))),h.promise())},e.prototype.onCarouselElementReady=function(){this._setupTransitionEndListener()},o.prototype._setupTransitionEndListener=function(){var e=t(this._carousel.getScrollerWrap());e.on("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",this._eventListeners.transitionEnd),this._transitionEndListenerCreated=!0},o.prototype._onRawTransitionEnd=function(){this._resolveDeferred()},o.prototype._resolveDeferred=function(){null!==this._activeDeferred&&this._activeDeferred.resolve()},o}),i("AbstractRenderer",["jquery"],function(t){function e(){}return e.prototype.renderItem=function(t,e,i){throw new Error("Not implemented")},e.prototype.renderPlaceholder=function(e,i){return t("<div></div>")[0]},e.prototype.destroyItem=function(e){t(e).remove()},e.prototype.restoreInitialContents=function(t,e){},e.prototype.destroy=function(){},e}),i("HtmlRenderer",["AbstractRenderer","Deferred"],function(t,e){function i(){t.call(this)}return i.prototype=Object.create(t.prototype),i.prototype.renderItem=function(t,i,n){var r=new e;return r.resolve(n),r.promise()},i.prototype.restoreInitialContents=function(t,e){t.getItems().done(function(t){$(t).each(function(t,i){var n=$(i).attr("style");"string"==typeof n&&$(i).attr("style",n.replace("display: block;","")),$(e).append(i)})})},i}),i("AbstractNavigator",[],function(){function t(){this._carousel=null}return t.prototype.init=function(t){this._carousel=t,this._setup()},t.prototype.destroy=function(){},t.prototype._setup=function(){throw new Error("Not implemented")},t}),i("KeyboardNavigator",["AbstractNavigator","Config","Util"],function(t,e,i){function n(e){t.call(this),this._mouseEntered=!1,this._eventListeners={mouseenter:this._onRawMouseEnter.bind(this),mouseleave:this._onRawMouseLeave.bind(this),keydown:this._onRawKeyDown.bind(this)},this.setMode(e||n.Mode.NAVIGATE_PAGE)}return n.prototype=Object.create(t.prototype),n.Mode={NAVIGATE_PAGE:"navigate-page",NAVIGATE_ITEM:"navigate-item"},n.prototype.setMode=function(t){if(!i.objectHasValue(n.Mode,t))throw new Error('Invalid mode "'+t+'" provided');this._mode=t},n.prototype.getMode=function(){return this._mode},n.prototype._setup=function(){var t=$(this._carousel.getMainWrap()),e=$(window);t.on("mouseenter",this._eventListeners.mouseenter).on("mouseleave",this._eventListeners.mouseleave),e.on("keydown",this._eventListeners.keydown)},n.prototype.destroy=function(){var t=$(this._carousel.getMainWrap()),e=$(window);t.off("mouseenter",this._eventListeners.mouseenter).off("mouseleave",this._eventListeners.mouseleave),e.off("keydown",this._eventListeners.keydown)},n.prototype._onRawMouseEnter=function(){this._mouseEntered=!0},n.prototype._onRawMouseLeave=function(){this._mouseEntered=!1},n.prototype._onRawKeyDown=function(t){var e=this._onKeyDown(t.keyCode);return e===!1&&t.preventDefault(),e},n.prototype._onKeyDown=function(t){var i;if(this._mouseEntered){switch(this._carousel.getOrientation()){case e.Orientation.HORIZONTAL:i={previous:37,next:39};break;case e.Orientation.VERTICAL:i={previous:38,next:40}}switch(t){case i.next:return this._mode===n.Mode.NAVIGATE_PAGE?this._carousel.navigateToNextPage():this._mode===n.Mode.NAVIGATE_ITEM&&this._carousel.navigateToNextItem(),!1;case i.previous:return this._mode===n.Mode.NAVIGATE_PAGE?this._carousel.navigateToPreviousPage():this._mode===n.Mode.NAVIGATE_ITEM&&this._carousel.navigateToPreviousItem(),!1}return!0}},n}),i("DragNavigator",["AbstractNavigator","Config","Util"],function(t,e,i){function n(e){t.call(this),this._active=!1,this._startPosition=null,this._startOppositePosition=null,this._startCarouselPosition=null,this._startHoverItemIndex=null,this._startTargetElement=null,this._startWindowScrollTop=null,this._lastPosition=null,this._lastOppositePosition=null,this._accumulatedMagnitude={main:0,opposite:0},this._eventListeners={start:this._onRawStart.bind(this),move:this._onRawMove.bind(this),end:this._onRawEnd.bind(this),dragStart:this._onRawDragStart.bind(this)},this._noActionThreshold=15,this._firstMoveEvent=!0,this.setMode(e||n.Mode.NAVIGATE_PAGE)}return n.prototype=Object.create(t.prototype),n.Mode={NAVIGATE_PAGE:"navigate-page",NAVIGATE_ITEM:"navigate-item"},n.prototype.setMode=function(t){if(!i.objectHasValue(n.Mode,t))throw new Error('Invalid mode "'+t+'" provided');this._mode=t},n.prototype.getMode=function(){return this._mode},n.prototype._setup=function(){var t=$(this._carousel.getMainWrap()),e=$(this._carousel.getScrollerWrap()),i=$(window);e.on("mousedown touchstart",this._eventListeners.start),i.on("mousemove touchmove",this._eventListeners.move),i.on("mouseup touchend touchcancel",this._eventListeners.end),t.on("dragstart",this._eventListeners.dragStart)},n.prototype.destroy=function(){var t=$(this._carousel.getMainWrap()),e=$(this._carousel.getScrollerWrap()),i=$(window);e.off("mousedown touchstart",this._eventListeners.start),i.off("mousemove touchmove",this._eventListeners.move),i.off("mouseup touchend touchcancel",this._eventListeners.end),t.off("dragstart",this._eventListeners.dragStart)},n.prototype._onRawStart=function(t){if(1!==t.which&&"touchstart"!==t.type)return!0;var i,n=this._carousel.getOrientation(),r=n===e.Orientation.HORIZONTAL,o="touchstart"===t.type,s=o?t.originalEvent.changedTouches[0].pageX:t.pageX,a=o?t.originalEvent.changedTouches[0].pageY:t.pageY,h=t.target;return i=this._begin(r?s:a,r?a:s,h),i===!1?(t.preventDefault(),!1):!0},n.prototype._onRawMove=function(t){var i,n,r,o,s=this._carousel.getOrientation(),a=s===e.Orientation.HORIZONTAL;return this._active?(1!==t.which&&"touchmove"!==t.type?i=this._end():(n="touchmove"===t.type,r=n?t.originalEvent.changedTouches[0].pageX:t.pageX,o=n?t.originalEvent.changedTouches[0].pageY:t.pageY,i=this._move(a?r:o,a?o:r)),i===!1?(t.preventDefault(),!1):!0):!0},n.prototype._onRawEnd=function(t){var e,i;return this._active?1!==t.which&&"touchend"!==t.type&&"touchcancel"!==t.type?!0:(i=t.target,e=this._end(i),e===!1?(t.preventDefault(),!1):!0):!0},n.prototype._onRawDragStart=function(){return!1},n.prototype._begin=function(t,e,i){return i=i||null,this._carousel.isAnimating()?!0:(this._active=!0,this._startPosition=t,this._startOppositePosition=e,this._lastPosition=t,this._lastOppositePosition=e,this._startCarouselPosition=this._carousel.getAnimator().getCurrentPosition(),this._startHoverItemIndex=this._carousel.getHoverItemIndex(),this._startWindowScrollTop=$(window).scrollTop(),this._accumulatedMagnitude={main:0,opposite:0},this._firstMoveEvent=!0,null!==i&&(this._startTargetElement=i,this._disableClickHandler(i)),this._carousel._onDragBegin(this._startPosition,this._startOppositePosition,this._startCarouselPosition,this._startWindowScrollTop),!0)},n.prototype._move=function(t,e){if(!this._active)return!0;var i=t-this._startPosition;if(this._accumulatedMagnitude.main+=Math.abs(this._lastPosition-t),this._accumulatedMagnitude.opposite+=Math.abs(this._lastOppositePosition-e),this._lastPosition=t,this._lastOppositePosition=e,this._accumulatedMagnitude.main<this._accumulatedMagnitude.opposite)return this._end(),!0;if(this._firstMoveEvent)return this._firstMoveEvent=!1,!1;var n=this._startCarouselPosition+i,r=this._carousel.getItemSize(),o=this._carousel.getTotalSize(),s=this._carousel.getItemCountOnLastPage(),a=this._carousel.getConfig().dragNavigatorOverEdgeDragPositionMultiplier,h=0,u=-o+s*r;return(n>h||u>n)&&(n=this._startCarouselPosition+i*a),this._carousel.getAnimator().animateToPosition(n,!0,!0),!1},n.prototype._end=function(t){if(!this._active)return!0;var e,i,r,o=this._lastPosition-this._startPosition,s=this._lastOppositePosition-this._startOppositePosition,a=Math.sqrt(Math.pow(o,2)+Math.pow(s,2)),h=0>o?-1:1,u=this._carousel.getAnimator().getCurrentPosition(),d=this._carousel.getConfig().dragNavigatorIgnoreClickThreshold;switch(this._mode){case n.Mode.NAVIGATE_PAGE:e=this._carousel.getClosestPageIndexAtPosition(u,h),this._carousel.navigateToPage(e,!1,!0);break;case n.Mode.NAVIGATE_ITEM:e=this._carousel.getClosestItemIndexAtPosition(u,h),this._carousel.navigateToItem(e,!1,!0)}return null!==this._startHoverItemIndex&&null!==t&&t===this._startTargetElement&&(i=this._carousel.getHoverItemIndex(),null!==i&&(r=i===this._startHoverItemIndex,r&&d>a&&this._restoreClickHandler(t)),this._dragStartHoverItemIndex=null),this._carousel._onDragEnd(this._mode,this._startPosition,this._lastPosition,o,e,h,t),this._active=!1,this._startPosition=null,this._startOppositePosition=null,this._startCarouselPosition=null,this._startWindowScrollTop=null,this._lastPosition=null,this._accumulatedMagnitude={main:0,opposite:0},this._firstMoveEvent=!0,!1},n.prototype._disableClickHandler=function(t){var e=$(t),i=this._carousel.getConfig().getClassName("item"),n=e.closest("."+i),r=n.find("*"),o=this._carousel.getConfig().cssPrefix+"click-disabled",s=n.data(o);s!==!0&&(r.on("click",this._ignoreEvent),n.data(o,!0))},n.prototype._restoreClickHandler=function(t){var e=$(t),i=this._carousel.getConfig().getClassName("item"),n=this._carousel.getConfig().cssPrefix+"click-disabled",r=e.closest("."+i),o=r.find("*"),s=r.data(n);s===!0&&(o.off("click",this._ignoreEvent),r.data(n,!1))},n.prototype._ignoreEvent=function(t){return t.preventDefault(),t.stopPropagation(),!1},n}),function(){function t(){}function e(t,e){for(var i=t.length;i--;)if(t[i].listener===e)return i;return-1}function n(t){return function(){return this[t].apply(this,arguments)}}var r=t.prototype,o=this,s=o.EventEmitter;r.getListeners=function(t){var e,i,n=this._getEvents();if(t instanceof RegExp){e={};for(i in n)n.hasOwnProperty(i)&&t.test(i)&&(e[i]=n[i])}else e=n[t]||(n[t]=[]);return e},r.flattenListeners=function(t){var e,i=[];for(e=0;e<t.length;e+=1)i.push(t[e].listener);return i},r.getListenersAsObject=function(t){var e,i=this.getListeners(t);return i instanceof Array&&(e={},e[t]=i),e||i},r.addListener=function(t,i){var n,r=this.getListenersAsObject(t),o="object"==typeof i;for(n in r)r.hasOwnProperty(n)&&-1===e(r[n],i)&&r[n].push(o?i:{listener:i,once:!1});return this},r.on=n("addListener"),r.addOnceListener=function(t,e){return this.addListener(t,{listener:e,once:!0})},r.once=n("addOnceListener"),r.defineEvent=function(t){return this.getListeners(t),this},r.defineEvents=function(t){for(var e=0;e<t.length;e+=1)this.defineEvent(t[e]);return this},r.removeListener=function(t,i){var n,r,o=this.getListenersAsObject(t);for(r in o)o.hasOwnProperty(r)&&(n=e(o[r],i),-1!==n&&o[r].splice(n,1));return this},r.off=n("removeListener"),r.addListeners=function(t,e){return this.manipulateListeners(!1,t,e)},r.removeListeners=function(t,e){return this.manipulateListeners(!0,t,e)},r.manipulateListeners=function(t,e,i){var n,r,o=t?this.removeListener:this.addListener,s=t?this.removeListeners:this.addListeners;if("object"!=typeof e||e instanceof RegExp)for(n=i.length;n--;)o.call(this,e,i[n]);else for(n in e)e.hasOwnProperty(n)&&(r=e[n])&&("function"==typeof r?o.call(this,n,r):s.call(this,n,r));return this},r.removeEvent=function(t){var e,i=typeof t,n=this._getEvents();if("string"===i)delete n[t];else if(t instanceof RegExp)for(e in n)n.hasOwnProperty(e)&&t.test(e)&&delete n[e];else delete this._events;return this},r.removeAllListeners=n("removeEvent"),r.emitEvent=function(t,e){var i,n,r,o,s=this.getListenersAsObject(t);for(r in s)if(s.hasOwnProperty(r))for(n=s[r].length;n--;)i=s[r][n],i.once===!0&&this.removeListener(t,i.listener),o=i.listener.apply(this,e||[]),o===this._getOnceReturnValue()&&this.removeListener(t,i.listener);return this},r.trigger=n("emitEvent"),r.emit=function(t){var e=Array.prototype.slice.call(arguments,1);return this.emitEvent(t,e)},r.setOnceReturnValue=function(t){return this._onceReturnValue=t,this},r._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:!0},r._getEvents=function(){return this._events||(this._events={})},t.noConflict=function(){return o.EventEmitter=s,t},"function"==typeof i&&i.amd?i("EventEmitter",[],function(){return t}):"object"==typeof module&&module.exports?module.exports=t:this.EventEmitter=t}.call(this),i("Exporter",[],function(){return{"export":function(t){"function"==typeof window.define&&window.define.amd&&window.define("FlowCarousel",[],function(){return t}),window.FlowCarousel=t}}}),i("FlowCarousel",["jquery","Config","AbstractDataSource","ArrayDataSource","HtmlDataSource","AbstractAnimator","DefaultAnimator","AbstractRenderer","HtmlRenderer","AbstractNavigator","KeyboardNavigator","DragNavigator","Deferred","Util","EventEmitter","Exporter"],function(t,e,i,n,r,o,s,a,h,u,d,l,c,p,f,_){function m(){this.version="0.1.0",this._id=m.instanceCount,this._initiated=!1,this._destroyed=!1,this._config=new e,this._dataSource=null,this._renderer=null,this._animator=null,this._navigators={},this._mainWrap=null,this._itemsWrap=null,this._scrollerWrap=null,this._isAnimating=!1,this._isDragged=!1,this._targetItemIndex=0,this._currentItemIndex=0,this._hoverItemIndex=null,this._renderedItemIndexes=[],this._renderedPlaceholderIndexes=[],this._itemIndexToElementMap={},this._delayedTasks={},this._getItemsPromise=null,this._activeAnimationDeferred=null,this._startupItemsRenderedEmitted=!1,this._lastLargestChildSize=null,this._cache={wrapSize:null,wrapOppositeSize:null},this._eventListeners={onWindowResize:this._onWindowResize.bind(this)},this._emptyCache=p.cloneObj(this._cache),this._useCache=!0,m.instanceCount++}return m.prototype=Object.create(f.prototype),m.instanceCount=0,m.liveCount=0,m.Config=e,m.AbstractDataSource=i,m.ArrayDataSource=n,m.HtmlDataSource=r,m.AbstractRenderer=a,m.HtmlRenderer=h,m.AbstractAnimator=o,m.DefaultAnimator=s,m.AbstractNavigator=u,m.KeyboardNavigator=d,m.DragNavigator=l,m.Deferred=c,m.SizeMode={INNER:"inner",OUTER:"outer"},m.Event={INITIATING:"initiating",INITIATED:"initiated",STARTUP_ITEMS_RENDERED:"startup-items-rendered",LOADING_ITEMS:"loading-items",LOADED_ITEMS:"loaded-items",ABORTED_ITEMS:"aborted-items",RENDERED_ITEMS:"rendered-items",DESTROYED_ITEMS:"destroyed-items",NAVIGATING_TO_ITEM:"navigating-to-item",NAVIGATED_TO_ITEM:"navigated-to-item",NAVIGATING_TO_PAGE:"navigating-to-page",NAVIGATED_TO_PAGE:"navigated-to-page",LAYOUT_CHANGED:"layout-changed",DRAG_BEGIN:"drag-begin",DRAG_END:"drag-end"},m.prototype.init=function(t,e){var n=new c;if(this._initiated)throw new Error("The carousel is already initiated");if(this.emit(m.Event.INITIATING),p.isObject(e)&&this._config.extend(e),this._setupElement(t),this._config.dataSource instanceof i||p.isArray(this._config.dataSource))this.setDataSource(this._config.dataSource);else{if("undefined"!=typeof this._config.dataSource&&null!==this._config.dataSource)throw new Error('Unexpected data source type "'+typeof this._config.dataSource+'" provided');null===this._dataSource&&(this._dataSource=new r(this._mainWrap))}if(null!==this._config.renderer){if(!(this._config.renderer instanceof a))throw new Error("Custom renderer provided in config but it's not an instance of AbstractRenderer");this._renderer=this._config.renderer}else if(this._dataSource instanceof r)this._renderer=new h;else if(null===this._renderer)throw new Error('Expecting a custom "renderer" to be defined in the config if not using the HtmlDataSource');if(null!==this._config.animator){if(!(this._config.animator instanceof o))throw new Error("Custom animator provided in config but it's not an instance of AbstractAnimator");this._animator=this._config.animator}else null===this._animator&&(this._animator=new s(this));return this._setupCarousel(this._mainWrap,this._config.orientation),this._setupDefaultNavigators(),this._initiated=!0,m.liveCount++,this.emit(m.Event.INITIATED),this._validateItemsToRender().done(function(){this.validateSize(),n.resolve()}.bind(this)),n.done(function(){this._setupWindowResizeListener()}.bind(this)),n.promise()},m.prototype.destroy=function(){var e,n,r=["isInitiated","isDestroyed"];if(!this._initiated)throw new Error("Unable to destroy carousel that has not been initiated");this._dataSource instanceof i&&this._dataSource.destroy(),this._renderer instanceof a&&this._renderer.destroy(),this._animator instanceof o&&this._animator.destroy();for(e in this._navigators)this._navigators[e]instanceof u&&this._navigators[e].destroy();p.removeElementClassesPrefixedWith(this._mainWrap,this._config.cssPrefix),t(this._mainWrap).empty(),this._renderer.restoreInitialContents(this._dataSource,this._mainWrap),t(this._mainWrap).data(this._config.dataTarget,null),t(window).off("resize",this._eventListeners.onWindowResize),this._config=null,this._dataSource=null,this._renderer=null,this._animator=null,this._navigators={},this._mainWrap=null,this._itemsWrap=null,this._scrollerWrap=null,this._isAnimating=!1,this._targetItemIndex=0,this._currentItemIndex=0,this._hoverItemIndex=null,this._renderedItemIndexes=[],this._renderedPlaceholderIndexes=[],this._itemIndexToElementMap={},this._delayedTasks={},this._getItemsPromise=null,this._activeAnimationDeferred=null,this._startupItemsRenderedEmitted=!1,this._lastLargestChildSize=null,this._cache=p.cloneObj(this._emptyCache),this._useCache=!0;for(n in this)-1===r.indexOf(n)&&"function"==typeof this[n]&&(this[n]=function(){throw new Error('The carousel is destroyed, attempting to call any of its methods results in an error (tried to call "'+this.name+'")')}.bind({name:n}));this._initiated=!1,this._destroyed=!0,m.liveCount--},m.prototype.isInitiated=function(){return this._initiated},m.prototype.isDestroyed=function(){return this._destroyed},m.prototype.isAnimating=function(){return this._isAnimating},m.prototype.isDragged=function(){return this._isDragged},m.prototype.getConfig=function(){return this._config},m.prototype.getAnimator=function(){return this._animator},m.prototype.getMainWrap=function(){return this._mainWrap},m.prototype.getItemsWrap=function(){return this._itemsWrap},m.prototype.getScrollerWrap=function(){return this._scrollerWrap},m.prototype.getOrientation=function(){return this._config.orientation},m.prototype.getItemSize=function(){var t=this._getMainWrapSize(),e=this._config.getItemsPerPage(t);return this._calculateItemSize(t,e)},m.prototype.getPageSize=function(){var t=this._getMainWrapSize(),e=this._config.getItemsPerPage(t),i=this._calculateItemSize(t,e);return e*i},m.prototype.getTotalSize=function(){var t=this._getMainWrapSize(),e=this._dataSource.getItemCount(),i=this._config.getItemsPerPage(t),n=this._calculateItemSize(t,i);return e*n},m.prototype.getItemCount=function(){return this._dataSource.getItemCount()},m.prototype.getItemCountOnLastPage=function(){var t=this.getItemCount(),e=this.getItemsPerPage(),i=this.getPageCount();return t-(i-1)*e},m.prototype.getPageCount=function(){return Math.ceil(this._dataSource.getItemCount()/this.getItemsPerPage())},m.prototype.getItemsPerPage=function(){var t=this._getMainWrapSize(),e=this._config.getItemsPerPage(t);return this._cache.itemsPerPage=e,e},m.prototype.getTargetItemIndex=function(){return this._targetItemIndex},m.prototype.getCurrentItemIndex=function(){return this._currentItemIndex},m.prototype.getHoverItemIndex=function(){return this._hoverItemIndex},m.prototype.getCurrentPageIndex=function(){var t=this.getItemsPerPage();return Math.floor(this._currentItemIndex/t)},m.prototype.getCurrentItemPosition=function(){return this._animator.getCurrentPosition()},m.prototype.getItemPositionByIndex=function(t){var e=this.getItemSize(),i=this.getItemsPerPage(),n=this._config.margin,r=n*(i-1)/i;return-Math.floor(t*e+t*(n-r))},m.prototype.getClosestItemIndexAtPosition=function(t,e){e=e||1;var i,n=this.getItemSize(),r=this.getItemCount(),o=this.getItemsPerPage(),s=this._config.margin,a=s*(o-1)/o,h=-t/(n+(s-a));return i=0>e?Math.ceil(h):Math.floor(h),Math.min(Math.max(i,0),r-o)},m.prototype.getClosestPageIndexAtPosition=function(t,e){e=e||1;var i,n=this.getClosestItemIndexAtPosition(t,e),r=this.getItemsPerPage(),o=this.getPageCount(),s=n/r;return i=0>e?Math.ceil(s):Math.floor(s),Math.min(Math.max(i,0),o-1)},m.prototype.getRenderRange=function(t){t=t||this._currentItemIndex;var e=this.getItemsPerPage(),i=this._dataSource.getItemCount();return this._config.getRenderRange(t,e,i)},m.prototype.getRenderedRange=function(){var t,e,i={start:null,end:null};for(e=0;e<this._renderedItemIndexes.length;e++)t=this._renderedItemIndexes[e],t=parseInt(t,10),(null===i.start||t<i.start)&&(i.start=t),(null===i.end||t>i.end)&&(i.end=t);return null===i.start||null===i.end?null:i},m.prototype.isAnimating=function(){return this._isAnimating},m.prototype.setDataSource=function(t){if(t instanceof i)this._dataSource=t;else{if(!p.isArray(t))throw new Error('Invalid data of type "'+typeof t+'" provided, expected an instance of AbstractDataSource or a simple array');this._dataSource=new n(t)}return this},m.prototype.setRenderer=function(t){if(!(t instanceof a))throw new Error("Invalid renderer provided, expected an instance of AbstractRenderer");return this._renderer=t,this},m.prototype.addNavigator=function(t,e){if("undefined"!=typeof this._navigators[t])throw new Error('Navigator of type "'+t+'" already added');if(!(e instanceof u))throw new Error("The navigator is expected to be an instance of AbstractNavigator");this._navigators[t]=e,this._navigators[t].init(this)},m.prototype.getNavigatorByType=function(t){return"undefined"==typeof this._navigators[t]?null:this._navigators[t]},m.prototype.getDataSource=function(){return this._dataSource},m.prototype.navigateToItem=function(t,e,i){e="boolean"==typeof e?e:!1,i="boolean"==typeof i?i:!1;var n=new c,r=this._dataSource.getItemCount(),o=t===this._currentItemIndex,s=this.getItemsPerPage(),a=this.getCurrentItemIndex(),h=Math.min(a+1,r-s);if(0===r)return n.resolve(),n.promise();if(0>t)throw new Error('Invalid negative  index "'+t+'" requested');
if(t>r-1)throw new Error('Too large index "'+t+'" requested, there are only '+r+" items");return this._isAnimating?this._activeAnimationDeferred:o&&i!==!0?(0===t||this.isLastPage()&&t===h?this._showLimit(t).done(function(){n.resolve()}):n.resolve(),n.promise()):(this._isAnimating=!0,this._targetItemIndex=t,this._animator.animateToItem(t,e).done(function(){n.resolve()}),this.emit(m.Event.NAVIGATING_TO_ITEM,t,e),this._config.usePlaceholders&&this._dataSource.isAsynchronous()&&this._renderTargetIndexPlaceholders(),n.done(function(){this._currentItemIndex=this._targetItemIndex,this._isAnimating=!1,this._activeAnimationDeferred=null,this._destroyInvalidItems(),this._validateItemsToRender().done(function(){this.validateSize()}.bind(this)),this.emit(m.Event.NAVIGATED_TO_ITEM,t,e)}.bind(this)),this._activeAnimationDeferred=n,n.promise())},m.prototype.navigateToPage=function(t,e,i){e="boolean"==typeof e?e:!1;var n=this.getCurrentPageIndex(),r=t*this.getItemsPerPage(),o=this.getPageCount(),s=new c;return t===n&&i!==!0?(0===t||t===o-1?this._showLimit(r).done(function(){s.resolve()}):s.resolve(),s.promise()):(this.emit(m.Event.NAVIGATING_TO_PAGE,t,e),this.navigateToItem(r,e,i).done(function(){s.resolve()}),s.done(function(){this.emit(m.Event.NAVIGATED_TO_PAGE,t,e)}.bind(this)),s.promise())},m.prototype.navigateToNextItem=function(t){var e=this.getCurrentItemIndex(),i=this.getItemsPerPage(),n=this.getItemCount(),r=Math.min(e+1,n-i);return this.navigateToItem(r,t)},m.prototype.navigateToPreviousItem=function(t){var e=this.getCurrentItemIndex(),i=Math.max(e-1,0);return this.navigateToItem(i,t)},m.prototype.isFirstPage=function(t){return t="number"==typeof t?t:this.getCurrentPageIndex(),0===t},m.prototype.isLastPage=function(t){return t="number"==typeof t?t:this.getCurrentPageIndex(),0===this.getPageCount()||t===this.getPageCount()-1},m.prototype.navigateToNextPage=function(t){var e=this.getCurrentPageIndex(),i=this.getPageCount(),n=Math.min(e+1,i-1);return this.navigateToPage(n,t)},m.prototype.navigateToPreviousPage=function(t){var e=this.getCurrentPageIndex(),i=Math.max(e-1,0);return this.navigateToPage(i,t)},m.prototype.getCurrentPageVisibleRange=function(){var t=this.getItemsPerPage(),e=this.getItemCount();return{start:this._currentItemIndex,end:Math.max(Math.min(this._currentItemIndex+t-1,e-1),0)}},m.prototype.getCurrentPageVisibleItemElements=function(){var t,e,i=this.getItemCount(),n=this.getCurrentPageVisibleRange(),r=[];if(0===i)return[];for(e=n.start;e<=n.end;e++){if(t=this.getItemElementByIndex(e),null===t)throw new Error("Requested item element at index #"+e+" not found, this should not happen");r.push(t)}return r},m.prototype.getItemElementByIndex=function(t){var e=this.getItemCount();if(0===e)return null;if(0>t)throw new Error('Invalid negative  index "'+t+'" requested');if(t>e-1)throw new Error('Too large index "'+t+'" requested, there are only '+e+" items");return"undefined"==typeof this._itemIndexToElementMap[t]?null:this._itemIndexToElementMap[t]},m.prototype.redraw=function(){return this._reLayout()},m.prototype._setupElement=function(e){var i,n,r=t(e);if(0===r.length)throw new Error('Selector "'+i+'" did not match any elements');if(r.length>1)throw new Error('Selector "'+i+'" matches more then one element, try using "'+i+':first"');if(i=r[0],n=t(i).data(this._config.dataTarget),n instanceof m)throw new Error('Element matching selector "'+i+'" is already a carousel component, destroy the existing one first');this._mainWrap=i,t(this._mainWrap).data(this._config.dataTarget,this)},m.prototype._setupCarousel=function(i,n){var r,o,s=t(i),a={wrap:this._config.getClassName("wrap"),items:this._config.getClassName("items"),item:this._config.getClassName("item"),scroller:this._config.getClassName("scroller"),matchWrap:this._config.getClassName("matchWrap"),matchLargestItem:this._config.getClassName("matchLargestItem"),initiating:this._config.getClassName("initiating"),horizontal:this._config.getClassName("horizontal"),vertical:this._config.getClassName("vertical")},h=this._config.sizeMode,u=0;if(s.empty(),r=t("<div></div>",{"class":a.items}),o=t("<div></div>",{"class":a.scroller}),h===e.SizeMode.MATCH_WRAP)t(this._mainWrap).addClass(a.matchWrap);else{if(h!==e.SizeMode.MATCH_LARGEST_ITEM)throw new Error('Invalid size mode "'+h+'" defined');t(this._mainWrap).addClass(a.matchLargestItem)}if(r.append(o),s.append(r),this._itemsWrap=r[0],this._scrollerWrap=o[0],s.addClass(a.wrap),s.addClass(a.initiating),n===e.Orientation.HORIZONTAL)s.addClass(a.horizontal);else{if(n!==e.Orientation.VERTICAL)throw new Error('Unexpected orientation "'+n+'" provided');s.addClass(a.vertical)}if(null!==this._config.startItemIndex?u=this._config.startItemIndex:null!==this._config.startPageIndex&&(u=this._config.startPageIndex*this.getItemsPerPage()),this._animator.onCarouselElementReady(),this._setupLayout(u,this._config.animateToStartIndex),s.removeClass(a.initiating),null!==this._config.startItemIndex&&null!==this._config.startPageIndex)throw new Error("Set either the startItemIndex or startPageIndex option but not both")},m.prototype._setupLayout=function(i,n){var r=this._config.orientation,o=this._getMainWrapSize(),s=this._dataSource.getItemCount(),a=this._config.getItemsPerPage(o),h=this._calculateItemSize(o,a),u=Math.ceil(s*h),d=n!==!0,l=r===e.Orientation.HORIZONTAL?"width":"height";0!==o&&(t(this._scrollerWrap).css(l,u),"number"==typeof i&&0!==i&&(this._targetItemIndex=i,this._currentItemIndex=i,this.emit(m.Event.NAVIGATING_TO_ITEM,i,d),this._animator.animateToItem(i,d,!0).done(function(){this.emit(m.Event.NAVIGATED_TO_ITEM,i,d)}.bind(this))),this._config.usePlaceholders&&this._dataSource.isAsynchronous()&&this._renderTargetIndexPlaceholders(),this.emit(m.Event.LAYOUT_CHANGED))},m.prototype._setupDefaultNavigators=function(){var t,i,n=null;for(i=0;i<this._config.navigators.length;i++){switch(t=this._config.navigators[i]){case e.Navigator.KEYBOARD:n=new d(this._config.keyboardNavigatorMode);break;case e.Navigator.DRAG:n=new l(this._config.dragNavigatorMode);break;default:throw new Error('Navigator of type "'+t+'" is not supported')}null!==n&&this.addNavigator(t,n)}},m.prototype._validateItemsToRender=function(){var t=this.getRenderRange();return this._renderItemRange(t.start,t.end)},m.prototype._destroyInvalidItems=function(){var t,e,i,n=this.getRenderRange(),r=[],o=[],s=[];for(i=0;i<this._renderedPlaceholderIndexes.length;i++)if(t=this._renderedPlaceholderIndexes[i],t<n.start||t>n.end){if(e=this.getItemElementByIndex(t),null===e)throw new Error("Placeholder element at index #"+t+" not found, this should not happen");this._destroyItem(e,t),s.push(t)}else r.push(t);for(this._renderedPlaceholderIndexes=r,i=0;i<this._renderedItemIndexes.length;i++)if(t=this._renderedItemIndexes[i],t<n.start||t>n.end){if(e=this.getItemElementByIndex(t),null===e)throw new Error("Item element at index #"+t+" not found, this should not happen");this._destroyItem(e,t),s.push(t)}else o.push(t);s.length>0&&this.emit(m.Event.DESTROYED_ITEMS,s),this._renderedItemIndexes=o},m.prototype._destroyItem=function(t,e){this._renderer.destroyItem(t),this._removeItemIndexToElement(e)},m.prototype._renderTargetIndexPlaceholders=function(){var t=this._targetItemIndex,e=this.getRenderRange(t);this._renderItemPlaceholders(e.start,e.end)},m.prototype._renderItemPlaceholders=function(t,e){var i,n,r=[];for(n=t;e>=n;n++)-1!==this._renderedItemIndexes.indexOf(n)?r.push(null):(i=this._renderer.renderPlaceholder(this._config,n),r.push(i));this._insertRenderedElements(r,t,!0)},m.prototype._renderItemRange=function(e,i){var n,r=this,o=new c,s=this._config.getClassName("loading"),a=this.getRenderedRange(),h=null===a||e>=a.start?1:-1;return null!==a&&a.start===e&&a.end===i?(o.resolve(),o.promise()):(n=null===a?{start:e,end:i}:1===h?{start:Math.max(e,a.end+1),end:i}:{start:e,end:Math.min(i,a.start-1)},this._dataSource.isAsynchronous()&&t(this._mainWrap).addClass(s),null!==this._getItemsPromise&&("function"==typeof this._getItemsPromise.abort&&this._getItemsPromise.abort(),this._getItemsPromise._ignore=!0,this._getItemsPromise=null),this.emit(m.Event.LOADING_ITEMS,n.start,n.end),this._getItemsPromise=this._dataSource.getItems(n.start,n.end).done(function(e){if(r._initiated){if(this._ignore===!0)return void r.emit(m.Event.ABORTED_ITEMS,n.start,n.end,e);r.emit(m.Event.LOADED_ITEMS,n.start,n.end,e),r._getItemsPromise=null,r._dataSource.isAsynchronous()&&t(r._mainWrap).removeClass(s),r._renderItems(e,n.start).done(function(){this._startupItemsRenderedEmitted||(this.emit(m.Event.STARTUP_ITEMS_RENDERED),this._startupItemsRenderedEmitted=!0),o.resolve()}.bind(r))}}),o.promise())},m.prototype._renderItems=function(e,i){var n,r,o,s,a,h,u,d=new c,l=this.getRenderRange(),p=this._config.getClassName("rendering"),f=i+e.length-1,_=[];if(0===t(this._mainWrap).parent().length)return d.resolve(),d.promise();for(u=0;u<e.length;u++)o=e[u],r=i+u,n=r<l.start||r>l.end,n&&(a=this._itemIndexToElementMap[r],"undefined"!=typeof a&&(this._renderer.destroyItem(a),this._removeItemIndexToElement(r),h=this._renderedPlaceholderIndexes.indexOf(r),-1!==h&&this._renderedPlaceholderIndexes.splice(h,1))),s=-1!==this._renderedItemIndexes.indexOf(r)||n?null:this._renderer.renderItem(this._config,r,o),_.push(s);return t(this._mainWrap).addClass(p),c.when.apply(t,_).done(function(){if(!this._initiated)throw new Error("Carousel was destroyed before rendering items");t(this._mainWrap).removeClass(p),this._insertRenderedElements(arguments,i),this.emit(m.Event.RENDERED_ITEMS,i,f,arguments),d.resolve()}.bind(this)),d.promise()},m.prototype._insertRenderedElements=function(e,i,n){var r,o,s,a,h="function"==typeof document.createDocumentFragment,u=h?t(document.createDocumentFragment()):null,d=h?u:t(this._scrollerWrap);if(0!==t(this._mainWrap).parent().length){for(a=0;a<e.length;a++)null!==e[a]&&(r=i+a,n?-1===this._renderedPlaceholderIndexes.indexOf(r)&&(this._insertRenderedElement(d,e[a],r,!0),this._renderedPlaceholderIndexes.push(r)):(o=this._renderedPlaceholderIndexes.indexOf(r),-1!==o&&"undefined"!=typeof this._itemIndexToElementMap[r]&&(s=this._itemIndexToElementMap[r],this._renderer.destroyItem(s),this._removeItemIndexToElement(r),this._renderedPlaceholderIndexes.splice(o,1)),this._insertRenderedElement(d,e[a],r),this._renderedItemIndexes.push(r)));h&&t(this._scrollerWrap).append(u)}},m.prototype._insertRenderedElement=function(i,n,r,o){var s,a=t(n),h=this._config.orientation,u=this._config.sizeMode,d=this._getMainWrapSize(),l=this._getMainWrapOppositeSize(),c=this._config.getItemsPerPage(d),p=this._calculateItemSize(d,c),f=this._config.margin,_=f*(c-1)/c,m=Math.ceil(p-_),g=Math.floor(r*p+r*(f-_)),v=t("<div></div>"),I={};if(u==e.SizeMode.MATCH_WRAP&&0===l&&this._initiated)throw new Error("The wrap opposite size was calculated to be zero, this should not happen");if(h===e.Orientation.HORIZONTAL?(I.width=m,I.left=g,u==e.SizeMode.MATCH_WRAP&&(I.height=l)):h===e.Orientation.VERTICAL&&(I.height=m,I.top=g,u==e.SizeMode.MATCH_WRAP&&(I.width=l)),a.css("display","block"),s=a.wrap(v).parent(),s.css(I),s.addClass(this._config.getClassName("item")),o&&s.addClass(this._config.getClassName("placeholder")),this._preprocessItemElement(s,r),i.append(s),"undefined"!=typeof this._itemIndexToElementMap[r])throw new Error("Element at index #"+r+" already exists, this should not happen");this._mapItemIndexToElement(r,s[0])},m.prototype._mapItemIndexToElement=function(t,e){this._itemIndexToElementMap[t]=e},m.prototype._removeItemIndexToElement=function(t){delete this._itemIndexToElementMap[t]},m.prototype._preprocessItemElement=function(e,i){var n=this;e.data(this._config.cssPrefix+"index",i),e.hover(function(){var e=t(this).data(n._config.cssPrefix+"index");n._hoverItemIndex=e},function(){n._hoverItemIndex=null})},m.prototype.validateSize=function(){if(this._config.sizeMode===e.SizeMode.MATCH_LARGEST_ITEM){var i=this._getOppositeOrientation(this._config.orientation),n=this._config.orientation===e.Orientation.HORIZONTAL?"height":"width",r=this.getCurrentPageVisibleItemElements(),o=this._getLargestElementSize(r,i,m.SizeMode.OUTER);o>0&&o!==this._lastLargestChildSize&&(t(this._scrollerWrap).css(n,Math.ceil(o)+"px"),this._lastLargestChildSize=o)}},m.prototype._reLayout=function(){var t,e=this._currentItemIndex;return this._reset(),this._setupLayout(e),t=this._validateItemsToRender(),t.done(function(){this.validateSize()}.bind(this)),t},m.prototype._reset=function(){var e=t(this._scrollerWrap);e.empty().attr("style",null).data(this._config.cssPrefix+"last-size",null),this._itemIndexToElementMap={},this._isAnimating=!1,this._targetItemIndex=0,this._currentItemIndex=0,this._lastLargestChildSize=null,this._renderedItemIndexes=[],this._renderedPlaceholderIndexes=[],this._itemIndexToElementMap={},this._cache=p.cloneObj(this._emptyCache)},m.prototype._setupWindowResizeListener=function(){t(window).on("resize",this._eventListeners.onWindowResize)},m.prototype._onWindowResize=function(){this._initiated&&this._validateResponsiveLayout()},m.prototype._validateResponsiveLayout=function(e){if(this._isAnimating&&e!==!0)return!1;var i=t(this._mainWrap),n=i.data(this._config.cssPrefix+"last-size")||null,r=this._getMainWrapSize(!0);return i.data(this._config.cssPrefix+"last-size",r),null===n||r!==n&&0!==r?(this._performDelayed("re-layout",function(){this._reLayout()}.bind(this),this._config.responsiveLayoutDelay),!0):!1},m.prototype._showLimit=function(t){var e,i,n,r=new c,o=30;return this._isAnimating?r.resolve():(i=0===t?-1:1,e=this.getItemPositionByIndex(t),n=-1===i?e+o:e-o,this._isAnimating=!0,this._animator.animateToPosition(n).done(function(){this._animator.animateToPosition(e).done(function(){this._isAnimating=!1,r.resolve()}.bind(this))}.bind(this))),r.promise()},m.prototype._calculateItemSize=function(t,e){return t/e},m.prototype._getElementSize=function(i,n,r){r=r||m.SizeMode.INNER;var o=r===m.SizeMode.INNER?["innerWidth","innerHeight"]:["outerWidth","outerHeight"];if(n===e.Orientation.HORIZONTAL)return t(i)[o[0]]();if(n===e.Orientation.VERTICAL)return t(i)[o[1]]();throw new Error('Invalid orientation "'+n+'" requested')},m.prototype._getLargestElementSize=function(e,i,n){var r,o,s,a=0;return t(e).each(function(e,h){r=t(h).children(),o=r.length>0?r[0]:h,s=this._getElementSize(o,i,n),s>a&&(a=s)}.bind(this)),a},m.prototype._getMainWrapSize=function(e){if(this._useCache&&null!==this._cache.wrapSize&&e!==!0)return this._cache.wrapSize;var i=this._config.orientation;return this._cache.wrapSize=this._getElementSize(this._mainWrap,i),t(this._mainWrap).data(this._config.cssPrefix+"last-size",this._cache.wrapSize),this._cache.wrapSize},m.prototype._getMainWrapOppositeSize=function(t){if(this._useCache&&null!==this._cache.wrapOppositeSize&&t!==!0)return this._cache.wrapOppositeSize;var e=this._config.orientation,i=this._getOppositeOrientation(e);return this._cache.wrapOppositeSize=this._getElementSize(this._mainWrap,i),this._cache.wrapOppositeSize},m.prototype._getOppositeOrientation=function(t){return t===e.Orientation.HORIZONTAL?e.Orientation.VERTICAL:e.Orientation.HORIZONTAL},m.prototype._onDragBegin=function(t,e,i){this._dragging=!0,this.emit(m.Event.DRAG_BEGIN,t,e,i)},m.prototype._onDragEnd=function(t,e,i,n,r,o,s){this._dragging=!1,this.emit(m.Event.DRAG_END,t,e,i,r,n,o,s)},m.prototype._performDelayed=function(t,e,i){i=i||1e3,"undefined"!=typeof this._delayedTasks[t]&&null!==this._delayedTasks[t]&&(window.clearTimeout(this._delayedTasks[t]),this._delayedTasks[t]=null),this._delayedTasks[t]=window.setTimeout(function(){this._delayedTasks[t]=null,e.apply(e,[t,i])}.bind(this),i)},_.export(m),m}),e("FlowCarousel")});
//# sourceMappingURL=FlowCarousel.min.js.map