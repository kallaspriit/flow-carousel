<!DOCTYPE html>
<html>
<head lang="en">
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1 minimum-scale=1, maximum-scale=1, user-scalable=no">
	<meta name="HandheldFriendly" content="True">
	<meta name="msapplication-tap-highlight" content="no" />
	<title>FlowCarousel RequireJS example</title>
	<link rel="stylesheet" href="../dist/flow-carousel.css">
	<link rel="stylesheet" href="examples.css">
</head>
<body>
	<h1>FlowCarousel</h1>

	<h2>Basic horizontal carousel with default options</h2>
	<div id="basic-carousel" class="carousel carousel-horizontal">
		<div class="carousel-item carousel-item-odd">0</div>
		<div class="carousel-item">1</div>
		<div class="carousel-item carousel-item-odd">2</div>
		<div class="carousel-item">3</div>
		<div class="carousel-item carousel-item-odd">4</div>
		<div class="carousel-item">5</div>
		<div class="carousel-item carousel-item-odd">6</div>
		<div class="carousel-item">7</div>
		<div class="carousel-item carousel-item-odd">8</div>
		<div class="carousel-item">9</div>
		<div class="carousel-item carousel-item-odd">10</div>
		<div class="carousel-item">11</div>
		<div class="carousel-item carousel-item-odd">12</div>
		<div class="carousel-item">13</div>
		<div class="carousel-item carousel-item-odd">14</div>
		<div class="carousel-item">15</div>
	</div>
	<div class="controls">
		<button class="btn" data-action="previous-page" data-target="#basic-carousel">Previous page</button>
		<button class="btn" data-action="previous-item" data-target="#basic-carousel">Previous item</button>
		-
		<button class="btn" data-action="next-item" data-target="#basic-carousel">Next item</button>
		<button class="btn" data-action="next-page" data-target="#basic-carousel">Next page</button>
		-
		<button class="btn" data-action="destroy" data-target="#basic-carousel">Destroy</button>
		<button class="btn" data-action="create" data-target="#basic-carousel">Create</button>
	</div>

	<h2>Single item carousel</h2>
	<div id="single-item-carousel" class="carousel carousel-horizontal" style="height: 400px;">
		<div class="carousel-item">0</div>
		<div class="carousel-item">1</div>
		<div class="carousel-item">2</div>
		<div class="carousel-item">3</div>
		<div class="carousel-item">4</div>
		<div class="carousel-item">5</div>
		<div class="carousel-item">6</div>
		<div class="carousel-item">7</div>
		<div class="carousel-item">8</div>
		<div class="carousel-item">9</div>
		<div class="carousel-item">10</div>
		<div class="carousel-item">11</div>
		<div class="carousel-item">12</div>
		<div class="carousel-item">13</div>
		<div class="carousel-item">14</div>
		<div class="carousel-item">15</div>
		<div class="carousel-item">16</div>
		<div class="carousel-item">17</div>
		<div class="carousel-item">18</div>
		<div class="carousel-item">19</div>
		<div class="carousel-item">20</div>
		<div class="carousel-item">21</div>
		<div class="carousel-item">22</div>
		<div class="carousel-item">23</div>
		<div class="carousel-item">24</div>
		<div class="carousel-item">25</div>
		<div class="carousel-item">26</div>
		<div class="carousel-item">27</div>
		<div class="carousel-item">28</div>
		<div class="carousel-item">29</div>
	</div>

	<h2>Custom asyncronous data source and renderer</h2>
	<div id="async-carousel" class="carousel carousel-horizontal"></div>
	<div class="controls">
		<button class="btn" data-action="previous-page" data-target="#async-carousel">Previous page</button>
		<button class="btn" data-action="previous-item" data-target="#async-carousel">Previous item</button>
		-
		<button class="btn" data-action="next-item" data-target="#async-carousel">Next item</button>
		<button class="btn" data-action="next-page" data-target="#async-carousel">Next page</button>
	</div>

	<h2>Carousel wrap matches the largest item size and navigate by item not page</h2>
	<div id="match-largest-element-carousel" class="carousel carousel-match-largest-element">
		<div class="carousel-item carousel-item-odd">0</div>
		<div class="carousel-item">1</div>
		<div class="carousel-item carousel-item-odd">2</div>
		<div class="carousel-item">3</div>
		<div class="carousel-item carousel-item-odd">4</div>
		<div class="carousel-item">5</div>
		<div class="carousel-item carousel-item-odd">6</div>
		<div class="carousel-item">7</div>
		<div class="carousel-item carousel-item-odd">8</div>
		<div class="carousel-item">9</div>
		<div class="carousel-item carousel-item-odd">10</div>
		<div class="carousel-item">11</div>
		<div class="carousel-item carousel-item-odd">12</div>
		<div class="carousel-item">13</div>
		<div class="carousel-item carousel-item-odd">14</div>
		<div class="carousel-item">15</div>
		<div class="carousel-item carousel-item-odd">16</div>
		<div class="carousel-item">17</div>
		<div class="carousel-item carousel-item-odd">18</div>
		<div class="carousel-item">19</div>
		<div class="carousel-item carousel-item-odd">20</div>
		<div class="carousel-item">21</div>
		<div class="carousel-item carousel-item-odd">22</div>
		<div class="carousel-item">23</div>
		<div class="carousel-item carousel-item-odd">24</div>
		<div class="carousel-item">25</div>
		<div class="carousel-item carousel-item-odd">26</div>
		<div class="carousel-item">27</div>
		<div class="carousel-item carousel-item-odd">28</div>
		<div class="carousel-item">29</div>
	</div>
	<div class="controls">
		<button class="btn" data-action="previous-page" data-target="#match-largest-element-carousel">Previous page</button>
		<button class="btn" data-action="previous-item" data-target="#match-largest-element-carousel">Previous item</button>
		-
		<button class="btn" data-action="next-item" data-target="#match-largest-element-carousel">Next item</button>
		<button class="btn" data-action="next-page" data-target="#match-largest-element-carousel">Next page</button>
		-
		<button class="btn" data-action="randomize-sizes" data-target="#match-largest-element-carousel">Randomize sizes</button>
	</div>

	<h2>Half-width horizontal carousel with margin and start index of 3</h2>
	<div id="half-width-carousel" class="carousel carousel-horizontal carousel-halfwidth">
		<div class="carousel-item">0</div>
		<div class="carousel-item">1</div>
		<div class="carousel-item">2</div>
		<div class="carousel-item">3</div>
		<div class="carousel-item">4</div>
		<div class="carousel-item">5</div>
		<div class="carousel-item">6</div>
		<div class="carousel-item">7</div>
		<div class="carousel-item">8</div>
		<div class="carousel-item">9</div>
		<div class="carousel-item">10</div>
		<div class="carousel-item">11</div>
		<div class="carousel-item">12</div>
		<div class="carousel-item">13</div>
		<div class="carousel-item">14</div>
		<div class="carousel-item">15</div>
		<div class="carousel-item">16</div>
		<div class="carousel-item">17</div>
		<div class="carousel-item">18</div>
		<div class="carousel-item">19</div>
		<div class="carousel-item">20</div>
		<div class="carousel-item">21</div>
		<div class="carousel-item">22</div>
		<div class="carousel-item">23</div>
		<div class="carousel-item">24</div>
		<div class="carousel-item">25</div>
		<div class="carousel-item">26</div>
		<div class="carousel-item">27</div>
		<div class="carousel-item">28</div>
		<div class="carousel-item">29</div>
	</div>
	<div class="controls">
		<button class="btn" data-action="previous-page" data-target="#half-width-carousel">Previous page</button>
		<button class="btn" data-action="previous-item" data-target="#half-width-carousel">Previous item</button>
		-
		<button class="btn" data-action="next-item" data-target="#half-width-carousel">Next item</button>
		<button class="btn" data-action="next-page" data-target="#half-width-carousel">Next page</button>
	</div>

	<h2>Vertical non-responsive carousel</h2>
	<div id="vertical-carousel" class="carousel carousel-vertical">
		<div class="carousel-item">0</div>
		<div class="carousel-item">1</div>
		<div class="carousel-item">2</div>
		<div class="carousel-item">3</div>
		<div class="carousel-item">4</div>
		<div class="carousel-item">5</div>
		<div class="carousel-item">6</div>
		<div class="carousel-item">7</div>
		<div class="carousel-item">8</div>
		<div class="carousel-item">9</div>
		<div class="carousel-item">10</div>
		<div class="carousel-item">11</div>
		<div class="carousel-item">12</div>
		<div class="carousel-item">13</div>
		<div class="carousel-item">14</div>
		<div class="carousel-item">15</div>
		<div class="carousel-item">16</div>
		<div class="carousel-item">17</div>
		<div class="carousel-item">18</div>
		<div class="carousel-item">19</div>
		<div class="carousel-item">20</div>
		<div class="carousel-item">21</div>
		<div class="carousel-item">22</div>
		<div class="carousel-item">23</div>
		<div class="carousel-item">24</div>
		<div class="carousel-item">25</div>
		<div class="carousel-item">26</div>
		<div class="carousel-item">27</div>
		<div class="carousel-item">28</div>
		<div class="carousel-item">29</div>
	</div>
	<div class="controls">
		<button class="btn" data-action="previous-page" data-target="#vertical-carousel">Previous page</button>
		<button class="btn" data-action="previous-item" data-target="#vertical-carousel">Previous item</button>
		-
		<button class="btn" data-action="next-item" data-target="#vertical-carousel">Next item</button>
		<button class="btn" data-action="next-page" data-target="#vertical-carousel">Next page</button>
	</div>

	<h2>Carousel with links, images, dynamic height</h2>
	<div id="dynamic-carousel" class="carousel carousel-dynamic">
		<div class="carousel-item">0</div>
		<div class="carousel-item image-or-link">
			<img src="http://lorempixel.com/1920/1080/">
		</div>
		<div class="carousel-item image-or-link">
			<a href="javascript: alert('href clicked for #2');">2</a>
		</div>
		<div class="carousel-item image-or-link">
			<a href="javascript: alert('href clicked for #3');">3</a>
		</div>
		<div class="carousel-item">4</div>
		<div class="carousel-item">5</div>
		<div class="carousel-item">6</div>
		<div class="carousel-item">7</div>
		<div class="carousel-item">8</div>
		<div class="carousel-item">9</div>
		<div class="carousel-item">10</div>
		<div class="carousel-item">11</div>
		<div class="carousel-item">12</div>
		<div class="carousel-item">13</div>
		<div class="carousel-item">14</div>
		<div class="carousel-item">15</div>
		<div class="carousel-item">16</div>
		<div class="carousel-item">17</div>
		<div class="carousel-item">18</div>
		<div class="carousel-item">19</div>
		<div class="carousel-item">20</div>
		<div class="carousel-item">21</div>
		<div class="carousel-item">22</div>
		<div class="carousel-item">23</div>
		<div class="carousel-item">24</div>
		<div class="carousel-item">25</div>
		<div class="carousel-item">26</div>
		<div class="carousel-item">27</div>
		<div class="carousel-item">28</div>
		<div class="carousel-item">29</div>
	</div>
	<div class="controls">
		<button class="btn" data-action="change-height" data-target="#dynamic-carousel">Change elements height</button>
	</div>

	<button id="reload-btn">Reload</button>

	<script src="lib/require.js"></script>
	<script src="lib/jquery.js"></script>
	<script>

	// configure RequireJS
	require.config({
		baseUrl: '../src',
	});

	// fetch the carousel component and run it
	require([
		'FlowCarousel'
	], function(
		FlowCarousel
	) {
		// test asynchronous data source
		function CustomDataSource() {
			FlowCarousel.AbstractDataSource.call(this);

			var itemCount = 1000,
				i;

			this._data = [];

			for (i = 0; i < itemCount; i++) {
				this._data.push(i);
			}
		}

		CustomDataSource.prototype = Object.create(FlowCarousel.AbstractDataSource.prototype);

		CustomDataSource.prototype.getItemCount = function() {
			return this._data.length;
		};

		CustomDataSource.prototype.isAsynchronous = function() {
			return true;
		};

		CustomDataSource.prototype.getItems = function(startIndex, endIndex) {
			var deferred = new FlowCarousel.Deferred(),
				requestDuration = 1000; /// one second

			// fake asyncronous request that takes some time to complete
			window.setTimeout(function() {
				deferred.resolve(this._data.slice(startIndex, endIndex + 1));
			}.bind(this), requestDuration);

			return deferred.promise();
		};

		// renderer for the asyncronous data source
		function CustomRenderer() {
			FlowCarousel.AbstractRenderer.call(this);
		}

		CustomRenderer.prototype = Object.create(FlowCarousel.AbstractRenderer.prototype);

		CustomRenderer.prototype.renderItem = function(config, index, data) {
			var deferred = new FlowCarousel.Deferred();

			deferred.resolve($('<div class="carousel-item">test #' + data + '</div>'));

			return deferred.promise();
		};

		CustomRenderer.prototype.renderPlaceholder = function(config, index) {
			return $('<div>loading #' + index + '</div>')[0];
		};

		var basicCarousel = new FlowCarousel(),
			matchLargestElementCarousel = new FlowCarousel(),
			halfWidthCarousel = new FlowCarousel(),
			verticalCarousel = new FlowCarousel(),
			asyncCarousel = new FlowCarousel(),
			dynamicCarousel = new FlowCarousel(),
			singleItemCarousel = new FlowCarousel(),
			eventKey,
			eventName;

		// log events to console
		for (eventKey in FlowCarousel.Event) {
			eventName = FlowCarousel.Event[eventKey];

			basicCarousel.on(eventName, function() {
				console.log('event "' + this.eventName + '"', arguments);
			}.bind({ eventName: eventName }));
		}

		/*basicCarousel.init('#basic-carousel', {
			//startPageIndex: 2,
			//animateToStartIndex: true
			//keyboardNavigatorMode: FlowCarousel.KeyboardNavigator.Mode.NAVIGATE_ITEM
		});*/

		basicCarousel.init('#basic-carousel', {
			//dataSource: new CustomDataSource(),
			//renderer: new CustomRenderer()
		})

		/*.done(function() {
			basicCarousel.navigateToPage(1).done(function() {
				basicCarousel.navigateToPage(2).done(function() {
					basicCarousel.navigateToPage(1).done(function() {
						basicCarousel.navigateToPage(0).done(function() {

						});
					});
				});
			});
		});*/

		/*.done(function() {
			// try to get the out of range condition
			basicCarousel.navigateToNextPage().done(function() {
				console.log(basicCarousel.getCurrentPageIndex(), 1);
				console.log($('.flow-carousel-placeholder').length > 0, true);

				basicCarousel.navigateToPreviousPage().done(function() {
					console.log(basicCarousel.getCurrentPageIndex(), 0);
					console.log($('.flow-carousel-placeholder').length, 0);
				});
			});
		});*/

		// set random heights for the items
		/*$('#match-largest-element-carousel .carousel-item').each(function() {
			$(this).css('height', (100 + Math.random() * 200) + 'px');
		});

		matchLargestElementCarousel.init('#match-largest-element-carousel', {
			sizeMode: FlowCarousel.Config.SizeMode.MATCH_LARGEST_ITEM,
			keyboardNavigatorMode: FlowCarousel.KeyboardNavigator.Mode.NAVIGATE_ITEM,
			dragNavigatorMode: FlowCarousel.DragNavigator.Mode.NAVIGATE_ITEM
		});

		halfWidthCarousel.init('#half-width-carousel', {
			margin: 60,
			startItemIndex: 3,
			//startPageIndex: 3, // or set the page instead
			animateToStartIndex: false
		});

		verticalCarousel.init('#vertical-carousel', {
			margin: 10,
			orientation: FlowCarousel.Config.Orientation.VERTICAL,
			useResponsiveLayout: false,
			itemsPerPage: 10
		});

		asyncCarousel
			.on(FlowCarousel.Event.INITIATED, function() {
				$('<div class="carousel-initiating"><div>Initiating...</div></div>')
					.appendTo(asyncCarousel.getMainWrap());

				// add data loading indicator
				$('<div class="carousel-loading"><div>Loading</div></div>')
					.appendTo(asyncCarousel.getMainWrap());
			})
			.on(FlowCarousel.Event.STARTUP_ITEMS_RENDERED, function() {
				$(asyncCarousel.getMainWrap()).find('.carousel-initiating').remove();
			})
			.on(FlowCarousel.Event.LOADING_ITEMS, function(startIndex, endIndex) {
				$(asyncCarousel.getMainWrap()).find('.carousel-loading').addClass('carousel-loading-visible');
			})
			.on(FlowCarousel.Event.LOADED_ITEMS, function(startIndex, endIndex, items) {
				$(asyncCarousel.getMainWrap()).find('.carousel-loading').removeClass('carousel-loading-visible');
			});

		asyncCarousel.init('#async-carousel', {
			margin: 10,
			dataSource: new CustomDataSource(),
			renderer: new CustomRenderer()
		});

		singleItemCarousel.init('#single-item-carousel', {
			margin: 10,
			useResponsiveLayout: false,
			itemsPerPage: 1
		});

		dynamicCarousel.init('#dynamic-carousel', {
			margin: 10,
			sizeMode: FlowCarousel.Config.SizeMode.MATCH_LARGEST_ITEM,
			//useResponsiveLayout: false,
			//itemsPerPage: 1
		});*/

		// setup buttons
		$('.btn').click(function() {
			var $btn = $(this),
				action = $(this).data('action'),
				target = $(this).data('target'),
				carouselWrap = $(target),
				carousel = carouselWrap.data('flow-carousel');

			switch (action) {
				case 'previous-page':
					carousel.navigateToPreviousPage();
				break;

				case 'previous-item':
					carousel.navigateToPreviousItem();
				break;

				case 'next-item':
					carousel.navigateToNextItem();
				break;

				case 'next-page':
					carousel.navigateToNextPage();
				break;

				case 'destroy':
					carousel.destroy();
				break;

				case 'create':
					carousel = new FlowCarousel();

					carousel.init('#' + carouselWrap.attr('id'));
				break;

				case 'change-height':
					if (!window.sizeToggle) {
						carouselWrap.find('.carousel-item').height('150px');
					} else {
						carouselWrap.find('.carousel-item').height('300px');
					};

					window.sizeToggle = !window.sizeToggle;
				break;

				case 'randomize-sizes':
					carouselWrap.find('.carousel-item').each(function() {
						$(this).css('height', (50 + Math.random() * 300) + 'px');
					});
				break;
			}
		});

		$('#reload-btn').click(function() {
			window.location.reload();
		});

		// register globally for testing via console
		window.b = basicCarousel;
		window.c = asyncCarousel;
		window.v = verticalCarousel;
		window.s = singleItemCarousel;
		window.d = dynamicCarousel;
	});

	</script>
</body>
</html>